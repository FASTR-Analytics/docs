<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation for the Background chapter and four FASTR modules."><link href=../02_module_data_quality_adjustments_documentation/ rel=prev><link href=../04_module_coverage_estimates_documentation/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.23"><title>Module 3 · Service Utilization - FASTR Methodology</title><link rel=stylesheet href=../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../stylesheets/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=teal> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#module-3-service-utilization class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="FASTR Methodology" class="md-header__button md-logo" aria-label="FASTR Methodology" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> FASTR Methodology </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Module 3 · Service Utilization </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Overview </a> </li> <li class=md-tabs__item> <a href=../00_background_documentation/ class=md-tabs__link> Background </a> </li> <li class=md-tabs__item> <a href=../01_module_data_quality_assessment_documentation/ class=md-tabs__link> Module 1 · Data Quality Assessment </a> </li> <li class=md-tabs__item> <a href=../02_module_data_quality_adjustments_documentation/ class=md-tabs__link> Module 2 · Data Quality Adjustments </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Module 3 · Service Utilization </a> </li> <li class=md-tabs__item> <a href=../04_module_coverage_estimates_documentation/ class=md-tabs__link> Module 4 · Coverage Estimates </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="FASTR Methodology" class="md-nav__button md-logo" aria-label="FASTR Methodology" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg> </a> FASTR Methodology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../00_background_documentation/ class=md-nav__link> <span class=md-ellipsis> Background </span> </a> </li> <li class=md-nav__item> <a href=../01_module_data_quality_assessment_documentation/ class=md-nav__link> <span class=md-ellipsis> Module 1 · Data Quality Assessment </span> </a> </li> <li class=md-nav__item> <a href=../02_module_data_quality_adjustments_documentation/ class=md-nav__link> <span class=md-ellipsis> Module 2 · Data Quality Adjustments </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Module 3 · Service Utilization </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Module 3 · Service Utilization </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-overview-what-why class=md-nav__link> <span class=md-ellipsis> 1. Overview (What &amp; Why) </span> </a> <nav class=md-nav aria-label="1. Overview (What & Why)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-does-this-module-do class=md-nav__link> <span class=md-ellipsis> What does this module do? </span> </a> </li> <li class=md-nav__item> <a href=#why-is-it-needed-in-the-fastr-pipeline class=md-nav__link> <span class=md-ellipsis> Why is it needed in the FASTR pipeline? </span> </a> </li> <li class=md-nav__item> <a href=#quick-summary class=md-nav__link> <span class=md-ellipsis> Quick Summary </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-how-it-works class=md-nav__link> <span class=md-ellipsis> 2. How It Works </span> </a> <nav class=md-nav aria-label="2. How It Works"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#high-level-workflow class=md-nav__link> <span class=md-ellipsis> High-Level Workflow </span> </a> </li> <li class=md-nav__item> <a href=#visual-workflow-diagram class=md-nav__link> <span class=md-ellipsis> Visual Workflow Diagram </span> </a> </li> <li class=md-nav__item> <a href=#key-decision-points class=md-nav__link> <span class=md-ellipsis> Key Decision Points </span> </a> </li> <li class=md-nav__item> <a href=#what-happens-to-the-data class=md-nav__link> <span class=md-ellipsis> What Happens to the Data </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-detailed-reference class=md-nav__link> <span class=md-ellipsis> 3. Detailed Reference </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../04_module_coverage_estimates_documentation/ class=md-nav__link> <span class=md-ellipsis> Module 4 · Coverage Estimates </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=module-3-service-utilization>Module 3: Service Utilization<a class=headerlink href=#module-3-service-utilization title="Anchor link to this section">&para;</a></h1> <h2 id=1-overview-what-why>1. Overview (What &amp; Why)<a class=headerlink href=#1-overview-what-why title="Anchor link to this section">&para;</a></h2> <h3 id=what-does-this-module-do>What does this module do?<a class=headerlink href=#what-does-this-module-do title="Anchor link to this section">&para;</a></h3> <p>The Service Utilization module analyzes health service delivery patterns to detect and quantify disruptions in service volumes over time. It identifies when health services deviate significantly from expected patterns and measures the magnitude of these disruptions at national, provincial, and district levels.</p> <p>Using statistical process control methods and regression analysis, the module compares actual service volumes against historical trends and seasonal patterns. This helps distinguish between normal fluctuations (like expected increases in malaria cases during rainy season) and genuine disruptions that require investigation (like sudden drops in antenatal care during a pandemic or conflict).</p> <p>The analysis produces quantified estimates of service shortfalls and surpluses, enabling evidence-based resource allocation, policy decisions, and health system monitoring.</p> <h3 id=why-is-it-needed-in-the-fastr-pipeline>Why is it needed in the FASTR pipeline?<a class=headerlink href=#why-is-it-needed-in-the-fastr-pipeline title="Anchor link to this section">&para;</a></h3> <p>Service utilization data reflects how populations access essential healthcare, but this data can fluctuate due to various factors: seasonal patterns, policy changes, external shocks (pandemics, natural disasters, conflicts), data quality issues, or service availability problems. Without systematic analysis, it's difficult to know whether observed changes represent normal variation or significant disruptions requiring action.</p> <p>This module provides objective, data-driven identification of service delivery problems and quantifies their impact. It enables health system managers to detect emerging issues early, target resources to affected areas, and monitor recovery after disruptions. The module's outputs support dashboard monitoring, impact assessments, and policy evaluation.</p> <h3 id=quick-summary>Quick Summary<a class=headerlink href=#quick-summary title="Anchor link to this section">&para;</a></h3> <table> <thead> <tr> <th><strong>Aspect</strong></th> <th><strong>Details</strong></th> </tr> </thead> <tbody> <tr> <td><strong>Inputs</strong></td> <td><code>hmis_SLE.csv</code> (raw service data), <code>M1_output_outliers.csv</code> (outlier flags), <code>M2_adjusted_data.csv</code> (adjusted counts)</td> </tr> <tr> <td><strong>Outputs</strong></td> <td><code>M3_chartout.csv</code> (disruption flags), <code>M3_disruptions_analysis_*.csv</code> (quantified impacts), <code>M3_all_indicators_shortfalls_*.csv</code> (shortfall/surplus summaries)</td> </tr> <tr> <td><strong>Purpose</strong></td> <td>Detect and quantify service delivery disruptions to support evidence-based health system monitoring and resource allocation</td> </tr> <tr> <td><strong>Analysis Method</strong></td> <td>Two-stage: (1) Control charts detect disruptions, (2) Panel regression quantifies impacts</td> </tr> <tr> <td><strong>Geographic Levels</strong></td> <td>National, Province, District, Ward (configurable)</td> </tr> <tr> <td><strong>Runtime</strong></td> <td>5-60 minutes depending on configuration</td> </tr> </tbody> </table> <hr> <h2 id=2-how-it-works>2. How It Works<a class=headerlink href=#2-how-it-works title="Anchor link to this section">&para;</a></h2> <h3 id=high-level-workflow>High-Level Workflow<a class=headerlink href=#high-level-workflow title="Anchor link to this section">&para;</a></h3> <p>The module operates in two sequential stages, each with a distinct purpose:</p> <p><strong>Stage 1: Control Chart Analysis</strong> - Identifies unusual patterns in service volumes</p> <ol> <li> <p><strong>Prepare the data</strong>: Load health service data, remove previously identified outliers, aggregate to the appropriate geographic level, and fill in missing months using interpolation.</p> </li> <li> <p><strong>Model expected patterns</strong>: For each combination of health indicator and geographic area, use robust statistical methods to estimate what service volumes should look like based on historical trends and seasonal patterns (e.g., accounting for predictable increases in malaria cases during rainy season).</p> </li> <li> <p><strong>Detect deviations</strong>: Compare actual service volumes to expected patterns and identify significant deviations using multiple detection rules:</p> </li> <li><strong>Sharp disruptions</strong>: Single months with extreme deviations</li> <li><strong>Sustained drops</strong>: Gradual declines over several months</li> <li><strong>Sustained dips</strong>: Periods consistently below expected levels</li> <li><strong>Sustained rises</strong>: Periods consistently above expected levels</li> <li> <p><strong>Missing data patterns</strong>: Gaps in reporting that may signal problems</p> </li> <li> <p><strong>Flag disrupted periods</strong>: Mark months where any disruption pattern is detected, ensuring recent months are always flagged for review.</p> </li> </ol> <p><strong>Stage 2: Disruption Analysis</strong> - Quantifies the impact of identified disruptions</p> <ol> <li> <p><strong>Apply regression models</strong>: Use panel regression at multiple geographic levels (national, provincial, district) to estimate how much service volumes changed during flagged disruption periods, controlling for trends and seasonality.</p> </li> <li> <p><strong>Calculate shortfalls and surpluses</strong>: Compare predicted volumes to actual volumes to quantify the magnitude of disruptions in absolute numbers and percentages.</p> </li> <li> <p><strong>Generate outputs</strong>: Create summary files showing disruption impacts at each geographic level, ready for visualization and reporting.</p> </li> </ol> <h3 id=visual-workflow-diagram>Visual Workflow Diagram<a class=headerlink href=#visual-workflow-diagram title="Anchor link to this section">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>┌─────────────────────────────────────────────────────────────────────────┐
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>│                      STAGE 1: CONTROL CHART ANALYSIS                    │
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>│                     (Identifies WHEN disruptions occur)                 │
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>├─────────────────────────────────────────────────────────────────────────┤
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>│                                                                         │
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>│  Load Data → Remove Outliers → Aggregate by Geography                  │
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>│       │                                                                 │
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>│       ▼                                                                 │
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>│  Fill Missing Months → Filter Low-Volume Periods                       │
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>│       │                                                                 │
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>│       ▼                                                                 │
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>│  For each indicator × geographic area:                                 │
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>│   ┌──────────────────────────────────────────────────────────┐         │
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>│   │ 1. Fit robust model: count ~ seasonality + time trend   │         │
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>│   │ 2. Smooth predictions to reduce noise                   │         │
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>│   │ 3. Calculate how far actual values deviate from expected│         │
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>│   │ 4. Apply detection rules (sharp, sustained, missing)    │         │
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>│   │ 5. Flag disrupted months                                │         │
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>│   └──────────────────────────────────────────────────────────┘         │
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>│       │                                                                 │
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>│       ▼                                                                 │
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>│  OUTPUT: M3_chartout.csv (disruption flags by month/area/indicator)    │
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>│                                                                         │
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>└────────────────────┬────────────────────────────────────────────────────┘
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>                     │
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>                     ▼
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>┌─────────────────────────────────────────────────────────────────────────┐
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>│                     STAGE 2: DISRUPTION ANALYSIS                        │
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>│                    (Quantifies HOW MUCH impact occurred)                │
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a>├─────────────────────────────────────────────────────────────────────────┤
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>│                                                                         │
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a>│  Join disruption flags to facility-level data                          │
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>│       │                                                                 │
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>│       ▼                                                                 │
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a>│  Run panel regressions at multiple levels:                             │
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a>│   ┌──────────────────────────────────────────────────────────┐         │
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a>│   │ National Level: Overall country impact                  │         │
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a>│   │ Province Level: Regional variation in impacts           │         │
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a>│   │ District Level: Local hotspots (optional)               │         │
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a>│   │ Ward Level: Finest geographic detail (optional)         │         │
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a>│   │                                                          │         │
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a>│   │ Each model estimates:                                   │         │
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a>│   │  • Expected service volume (adjusting for trends)       │         │
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a>│   │  • Effect of disruption periods                         │         │
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a>│   │  • Statistical significance                             │         │
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a>│   └──────────────────────────────────────────────────────────┘         │
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a>│       │                                                                 │
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a>│       ▼                                                                 │
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a>│  Calculate shortfalls and surpluses:                                   │
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a>│   • Absolute difference (number of services)                           │
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a>│   • Percentage difference (% change from expected)                     │
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a>│       │                                                                 │
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a>│       ▼                                                                 │
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a>│  OUTPUTS:                                                              │
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a>│   • M3_disruptions_analysis_*.csv (4 geographic levels)                │
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a>│   • M3_all_indicators_shortfalls_*.csv (summary statistics)            │
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a>│   • M3_service_utilization.csv (data for visualization)                │
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a>│                                                                         │
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59 href=#__codelineno-0-59></a>└─────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div> <h3 id=key-decision-points>Key Decision Points<a class=headerlink href=#key-decision-points title="Anchor link to this section">&para;</a></h3> <p><strong>Geographic Level Selection</strong>: The module can analyze disruptions at different geographic scales. You can choose to run analysis at national and provincial levels only (faster, suitable for routine monitoring) or include district and ward levels (slower, provides detailed local information for targeted interventions).</p> <p><strong>Sensitivity Settings</strong>: The module uses configurable thresholds to determine what constitutes a "disruption." More sensitive settings (lower thresholds) will flag smaller deviations, useful for early warning systems. More conservative settings (higher thresholds) will only flag major disruptions, useful for focusing on critical issues.</p> <p><strong>Data Completeness Approach</strong>: The module accepts different versions of service counts from Module 2, allowing you to choose whether to adjust for reporting completeness or use raw counts.</p> <h3 id=what-happens-to-the-data>What Happens to the Data<a class=headerlink href=#what-happens-to-the-data title="Anchor link to this section">&para;</a></h3> <p><strong>Input Transformation</strong>: The module starts with facility-level service counts (e.g., number of deliveries at each clinic each month) and aggregates them to geographic areas (provinces, districts). Outliers identified in Module 1 are removed to prevent anomalous data points from skewing the analysis.</p> <p><strong>Pattern Detection</strong>: Using robust statistical methods, the module learns what "normal" looks like for each service and area based on historical patterns. It then identifies months where actual volumes deviate significantly from these patterns, accounting for predictable variations like seasonal changes.</p> <p><strong>Impact Quantification</strong>: For months flagged as disrupted, the module uses regression models to estimate what service volumes would have been without the disruption. By comparing predicted to actual volumes, it calculates how many services were missed (shortfalls) or how much service delivery increased (surpluses).</p> <p><strong>Output Generation</strong>: The final outputs provide disruption impacts at multiple geographic scales, enabling users to see both national-level summaries and local-level details. All calculations preserve the original data while adding predicted values and disruption metrics.</p> <hr> <h2 id=3-detailed-reference>3. Detailed Reference<a class=headerlink href=#3-detailed-reference title="Anchor link to this section">&para;</a></h2> <details> <summary><strong>Configuration Parameters</strong></summary> ### Core Analysis Parameters | Parameter | Default | Type | Description | Tuning Guidance | |-----------|---------|------|-------------|-----------------| | `COUNTRY_ISO3` | "SLE" | String | Three-letter country code | Set to your country code | | `SELECTEDCOUNT` | "count_final_both" | String | Data column used for analysis | Options: `count_final_none`, `count_final_completeness`, `count_final_both` | | `VISUALIZATIONCOUNT` | "count_final_both" | String | Data column used for visualization | Should match or complement `SELECTEDCOUNT` | ### Control Chart Parameters | Parameter | Default | Type | Description | Tuning Guidance | |-----------|---------|------|-------------|-----------------| | `SMOOTH_K` | 7 | Integer (odd) | Rolling median window size in months | Larger values = smoother trends, less sensitivity. Must be odd number (e.g., 5, 7, 9, 11) | | `MADS_THRESHOLD` | 1.5 | Numeric | MAD units threshold for sharp disruptions | Lower = more sensitive (e.g., 1.0), higher = more conservative (e.g., 2.0) | | `DIP_THRESHOLD` | 0.90 | Numeric | Proportion threshold for sustained dips | 0.90 = flag if below 90% of expected (10% drop). Use 0.80 for 20% drop threshold | | `DIFFPERCENT` | 10 | Numeric | Percentage threshold for plotting disruptions | If actual differs from predicted by >10%, use predicted value in visualizations | **Note**: `RISE_THRESHOLD` is automatically calculated as `1 / DIP_THRESHOLD` (default: ~1.11) to mirror dip detection symmetrically. ### Geographic Analysis Parameters | Parameter | Default | Type | Description | Tuning Guidance | |-----------|---------|------|-------------|-----------------| | `CONTROL_CHART_LEVEL` | Auto-set | String | Geographic level for control charts | Automatically set based on `RUN_DISTRICT_MODEL` and `RUN_ADMIN_AREA_4_ANALYSIS` | | `RUN_DISTRICT_MODEL` | FALSE | Logical | Whether to run admin_area_3 regressions | Set TRUE for district-level analysis (increases runtime) | | `RUN_ADMIN_AREA_4_ANALYSIS` | FALSE | Logical | Whether to run admin_area_4 analysis | Set TRUE for finest-level analysis (very slow for large datasets) | ### Data Source Parameters | Parameter | Default | Type | Description | |-----------|---------|------|-------------| | `PROJECT_DATA_HMIS` | "hmis_SLE.csv" | String | Filename for raw HMIS data | ### Parameter Selection Guide **For High-Sensitivity Analysis** (detecting smaller disruptions): - `MADS_THRESHOLD = 1.0` - `DIP_THRESHOLD = 0.95` (5% drop) - `SMOOTH_K = 5` (less smoothing) **For Conservative Analysis** (only major disruptions): - `MADS_THRESHOLD = 2.0` - `DIP_THRESHOLD = 0.80` (20% drop) - `SMOOTH_K = 9` or `11` (more smoothing) **For Faster Runtime**: - `RUN_DISTRICT_MODEL = FALSE` - `RUN_ADMIN_AREA_4_ANALYSIS = FALSE` - `CONTROL_CHART_LEVEL = "admin_area_2"` </details> <details> <summary><strong>Input/Output Specifications</strong></summary> ### Input Requirements #### Primary Inputs 1. **`hmis_SLE.csv`** (or country-specific HMIS file) - Raw HMIS service utilization data - Required columns: `facility_id`, `admin_area_1`, `admin_area_2`, `admin_area_3`, `admin_area_4`, `indicator_common_id`, `period_id`, service count columns 2. **`M1_output_outliers.csv`** - Output from Module 1 (Data Quality Assessment) - Contains `outlier_flag` to exclude anomalous data points - Required columns: `facility_id`, `indicator_common_id`, `period_id`, `outlier_flag` 3. **`M2_adjusted_data.csv`** - Output from Module 2 (Data Quality Adjustments) - Contains adjusted service counts with different completeness assumptions - Required columns: `facility_id`, `indicator_common_id`, `period_id`, `count_final_none`, `count_final_completeness`, `count_final_both` #### Data Requirements - **Temporal coverage**: Minimum 12 months of data for seasonal modeling - **Data completeness**: Missing months are filled using interpolation - **Geographic completeness**: Data at specified administrative levels - **Count data**: Non-negative integer counts (predictions are bounded at zero) ### Outputs #### 1. Control Chart Results **`M3_chartout.csv`** - **Purpose**: Contains flagged disruptions from the control chart analysis - **Columns**: - `admin_area_*`: Geographic identifier (level depends on `CONTROL_CHART_LEVEL`) - `indicator_common_id`: Health service indicator code - `period_id`: Time period in YYYYMM format - `tagged`: Binary flag (1 = disruption detected, 0 = normal) - `count_original`: Actual service volume - `count_predict`: Predicted volume from regression - `count_smooth`: Smoothed prediction - `residual`: Deviation from expected - `robust_control`: Standardized residual - `tag_sharp`, `tag_sustained`, `tag_sustained_dip`, `tag_sustained_rise`, `tag_missing`: Individual disruption flags - **Use**: Identifies which months require further investigation for each indicator-geography combination **`M3_service_utilization.csv`** - **Purpose**: Pass-through copy of adjusted data for visualization - **Source**: Direct copy of `M2_adjusted_data.csv` - **Use**: Provides baseline data for plotting actual service volumes **`M3_memory_log.txt`** - **Purpose**: Tracks memory usage throughout execution - **Use**: Diagnostics for performance optimization and troubleshooting #### 2. Disruption Analysis Results **`M3_disruptions_analysis_admin_area_1.csv`** (National level - always generated) - **Columns**: - `admin_area_1`: Country name - `indicator_common_id`: Health service indicator - `period_id`: Time period (YYYYMM) - `count_sum`: Actual service volume (sum across all facilities) - `count_expect_sum`: Expected service volume (sum of predictions) - `count_expected_if_above_diff_threshold`: Value for plotting (expected if |difference| > DIFFPERCENT, otherwise actual) **`M3_disruptions_analysis_admin_area_2.csv`** (Province level - always generated) - **Additional column**: `admin_area_2` (province/region name) - **Same structure** as admin_area_1 file but disaggregated by province **`M3_disruptions_analysis_admin_area_3.csv`** (District level - conditional) - **Generated when**: `RUN_DISTRICT_MODEL = TRUE` - **Additional columns**: `admin_area_2`, `admin_area_3` - **Same structure** as above but disaggregated by district **`M3_disruptions_analysis_admin_area_4.csv`** (Ward level - conditional) - **Generated when**: `RUN_ADMIN_AREA_4_ANALYSIS = TRUE` - **Additional columns**: `admin_area_2`, `admin_area_3`, `admin_area_4` - **Warning**: Very large file size for countries with many wards #### 3. Shortfall/Surplus Summary Files **`M3_all_indicators_shortfalls_admin_area_*.csv`** (one for each geographic level) - **Purpose**: Pre-calculated shortfall and surplus metrics for reporting - **Common columns**: - Geographic identifier(s): `admin_area_*` - `indicator_common_id`: Health service indicator - `period_id`: Time period (YYYYMM) - `count_sum`: Actual service volume - `count_expect_sum`: Expected service volume - `shortfall_absolute`: Absolute number of missing services (if negative disruption) - `shortfall_percent`: Percentage shortfall relative to expected - `surplus_absolute`: Absolute number of excess services (if positive disruption) - `surplus_percent`: Percentage surplus relative to expected **Note**: If optional geographic levels are disabled, empty placeholder files are created for compatibility with downstream processes. #### Temporary Files (Automatically Cleaned) During execution, the module creates temporary batch files for memory management: - `M3_temp_controlchart_batch_*.csv` - `M3_temp_indicator_batch_*.csv` - `M3_temp_province_batch_*.csv` - `M3_temp_district_batch_*.csv` - `M3_temp_admin4_batch_*.csv` These are automatically deleted upon successful completion. If the script crashes, these files may remain and will be cleaned up on the next run. </details> <details> <summary><strong>Key Functions Documentation</strong></summary> ### `robust_control_chart(panel_data, selected_count)` **Purpose**: Identifies anomalies in service utilization using robust regression and MAD-based control limits. **Inputs**: - `panel_data`: Time series data for a specific indicator-geography combination - `selected_count`: Column name containing service volume counts to analyze **Process**: 1. Fits a robust linear model (using `MASS::rlm()`) with seasonal controls and time trends 2. Applies rolling median smoothing to predicted values to reduce noise 3. Calculates residuals and standardizes them using Median Absolute Deviation (MAD) 4. Applies rule-based tagging logic to identify different disruption types 5. Flags recent months automatically to ensure timely detection **Outputs**: - `count_predict`: Predicted service volume from robust regression - `count_smooth`: Smoothed predictions using rolling median - `residual`: Difference between actual and smoothed values - `robust_control`: Standardized residual (residual/MAD) - `tagged`: Binary flag (1 = disruption detected, 0 = normal variation) - Additional flags: `tag_sharp`, `tag_sustained`, `tag_sustained_dip`, `tag_sustained_rise`, `tag_missing` **Key Features**: - Handles missing data gracefully with interpolation - Uses robust regression to minimize influence of outliers - Employs multiple disruption detection rules for different patterns - Ensures non-negative predictions (counts cannot be negative) ### Panel Regression Models The disruption analysis uses fixed-effects panel regression models (`fixest::feols()`) at multiple geographic levels. **Country-wide Model** (Admin Area 1): <div class="language-r highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>count</span><span class=w> </span><span class=o>~</span><span class=w> </span><span class=n>date</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nf>factor</span><span class=p>(</span><span class=n>month</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tagged</span>
</span></code></pre></div> Clustered standard errors at district level (`admin_area_3`) **Province-level Models** (Admin Area 2): <div class="language-r highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>count</span><span class=w> </span><span class=o>~</span><span class=w> </span><span class=n>date</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nf>factor</span><span class=p>(</span><span class=n>month</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tagged</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>admin_area_2</span>
</span></code></pre></div> Separate regression for each province, clustered at district level **District-level Models** (Admin Area 3 - optional): <div class="language-r highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>count</span><span class=w> </span><span class=o>~</span><span class=w> </span><span class=n>date</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nf>factor</span><span class=p>(</span><span class=n>month</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tagged</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>admin_area_3</span>
</span></code></pre></div> Separate regression for each district, clustered at ward level (`admin_area_4`) **Ward-level Models** (Admin Area 4 - optional): <div class="language-r highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>count</span><span class=w> </span><span class=o>~</span><span class=w> </span><span class=n>date</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nf>factor</span><span class=p>(</span><span class=n>month</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tagged</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>admin_area_4</span>
</span></code></pre></div> Separate regression for each ward/finest unit ### Supporting Functions **`mem_usage(msg)`**: Tracks and logs memory consumption throughout execution **Data Processing**: - Batch processing with disk-based temporary files for memory efficiency - Efficient data.table operations for large datasets - Progressive aggregation and merging strategies </details> <details> <summary><strong>Statistical Methods & Algorithms</strong></summary> ### Control Chart Analysis Service volumes are aggregated at the specified geographic level (configurable via `CONTROL_CHART_LEVEL`). The pipeline removes outliers (`outlier_flag == 1`), fills in missing months, and filters low-volume months (<50% of global mean volume). A robust regression model estimates expected service volumes per indicator × geographic area (`panelvar`). A centered rolling median is applied to smooth the predicted values. Residuals (actual - smoothed) are standardized using MAD. Disruptions are identified using a rule-based tagging system. #### Disruption Detection Rules Each rule is controlled by user-defined parameters, allowing customization of the sensitivity and behavior of the detection logic: **Sharp Disruptions** Flags a single month when the standardized residual (residual divided by MAD) exceeds a threshold: $$ \left| \frac{\text{residual}}{\text{MAD}} \right| \geq \text{MADS_THRESHOLD} $$ - **Parameter:** `MADS_THRESHOLD` (default: `1.5`) - Lower values make the detection more sensitive to sudden spikes or dips. **Sustained Drops** Flags a sustained drop if: - Three consecutive months show mild deviations (standardized residual ≥ 1), and - The final month also exceeds the `MADS_THRESHOLD`. This captures slower, compounding declines. **Sustained Dips** Flags periods where the actual volume falls consistently below a defined proportion of expected volume (smoothed prediction): $$ \text{count\_original} < \text{DIP\_THRESHOLD} \times \text{count\_smooth} $$ - **Parameter:** `DIP_THRESHOLD` (default: `0.90`) - Users can adjust this to detect deeper or shallower dips (e.g., `0.80` for a 20% drop). **Sustained Rises** Symmetric to dips, flags periods of consistent overperformance: $$ \text{count\_original} > \text{RISE\_THRESHOLD} \times \text{count\_smooth} $$ - **Parameter:** `RISE_THRESHOLD` (default: `1 / DIP_THRESHOLD`, e.g., `1.11`) - Users can adjust this to detect upward surges in volume. **Missing Data** Flags when 2 or more of the past 3 months have missing (`NA`) or zero service volume. - **Fixed rule**. **Recent Tail Override** Automatically flags all months in the last 6 months of data to ensure recent trends are reviewed, even if model-based tagging is not conclusive. - **Fixed rule**. **Final Flag:** A month is assigned `tagged = 1` if **any** of the following conditions are met: - `tag_sharp == 1` - `tag_sustained == 1` - `tag_sustained_dip == 1` - `tag_sustained_rise == 1` - `tag_missing == 1` - It falls within the most recent 6 months (`last_6_months == 1`) ### Robust Regression Model **Model fitting:** - If ≥12 observations and >12 unique dates: $$Y_{it} = \beta_0 + \sum \gamma_m \cdot \text{month}_m + \beta_1 \cdot \text{date} + \epsilon_{it}$$ - If only ≥12 observations: $$Y_{it} = \beta_0 + \beta_1 \cdot \text{date} + \epsilon_{it}$$ - If insufficient data: use the median of observed values. **Apply rolling median smoothing** to predictions: $$ \text{count\_smooth}_{it} = \text{Median}(\text{count\_predict}_{t-k}, \dots, \text{count\_predict}_t, \dots, \text{count\_predict}_{t+k}) $$ - **Parameter:** `SMOOTH_K` (default: 7, must be odd) - Larger `SMOOTH_K` smooths more; smaller retains more variation. **Calculate residuals:** $$ \text{residual}_{it} = \text{count\_original}_{it} - \text{count\_smooth}_{it} $$ **Standardize residuals using MAD:** $$ \text{robust\_control}_{it} = \text{residual}_{it} / \text{MAD}_i $$ ### Disruption Analysis Regression Models Once anomalies are identified and saved in `M3_chartout.csv`, the disruption analysis quantifies their impact using regression models. These models estimate how much service utilization changed during the flagged disruption periods by adjusting for long-term trends and seasonal variations. For each indicator, we estimate: $$ Y_{it} = \beta_0 + \beta_1 \cdot \text{date} + \sum_{m=1}^{12} \gamma_m \cdot \text{month}_m + \beta_2 \cdot \text{tagged} + \epsilon_{it} $$ where: - $Y_{it}$ is the observed service volume, - $\text{date}$ captures time trends, - $\text{month}_m$ controls for seasonality, - $\text{tagged}$ is the disruption dummy (from the control chart analysis), - $\epsilon_{it}$ is the error term. The coefficient on `tagged` ($\beta_2$) measures the relative change in service utilization during flagged disruptions. Separate regressions are run at the national, province and district levels to assess the impact across different geographic scales. #### Country-wide Regression The country-wide regression estimates how service utilization changes at the national level when a disruption occurs. Instead of analyzing individual provinces or districts separately, this model considers the entire country's data in a single regression. Errors are clustered at the lowest available geographic level (`lowest_geo_level`), typically districts. **Model Specification:** $$Y_{it} = \beta_0 + \beta_1 \cdot \text{date} + \sum_{m=1}^{12} \gamma_m \cdot \text{month} + \beta_2 \cdot \text{tagged} + \epsilon_{it}$$ Where: - $Y_{it}$ = volume (e.g., number of deliveries) - $\text{date}$ = time trend - $\text{month}_m$ = controls for seasonality (factor variable) - $\text{tagged}$ = dummy for disruption period - $\epsilon_{it}$ = error term, clustered at the district level (`admin_area_3`) #### Province-level Regression The province-level disruption regression estimates how service utilization changes at the province level when a disruption occurs. Unlike the country-wide model, this approach runs separate regressions for each province to capture regional variations. **Model specification:** $$Y_{it} = \beta_0 + \beta_1 \cdot \text{date} + \sum_{m=1}^{12} \gamma_m \cdot \text{month} + \beta_2 \cdot \text{tagged} + \alpha_{\text{province}} + \epsilon_{it}$$ Where: - $Y_{it}$ = volume (e.g., number of deliveries) - $\text{date}$ = time trend - $\text{month}_m$ = controls for seasonality (factor variable) - $\text{tagged}$ = dummy for disruption period - $\alpha_{\text{province}}$ = province fixed effects - $\epsilon_{it}$ = error term, clustered at the district level #### District-level Regression The district-level disruption regression estimates how service utilization changes at the district level when a disruption occurs. This approach runs separate regressions for each district to capture localized variations. **Model specification:** $$Y_{it} = \beta_0 + \beta_1 \cdot \text{date} + \sum_{m=1}^{12} \gamma_m \cdot \text{month} + \beta_2 \cdot \text{tagged} + \alpha_{\text{district}} + \epsilon_{it}$$ Where: - $Y_{it}$ = volume (e.g., number of deliveries) - $\text{date}$ = time trend - $\text{month}_m$ = controls for seasonality (factor variable) - $\text{tagged}$ = dummy for disruption period - $\alpha_{\text{district}}$ = district fixed effects - $\epsilon_{it}$ = error term #### Regression Outputs Each regression level produces the following outputs: - **Expected values (`expect_admin_area_*`)**: Predicted service volume adjusted for seasonality and trends. - **Disruption effect (`b_admin_area_*`)**: Estimated relative change during disruptions: $$ b_{\text{admin\_area\_*}} = -\frac{\text{diff mean}}{\text{predict mean}} $$ - **Trend coefficient (`b_trend_admin_area_*`)**: Reflects long-term trend. - Positive = increasing service use - Negative = declining service use - Near zero = stable trend - **P-value (`p_admin_area_*`)**: Measures statistical significance of the disruption effect. - Lower values = stronger evidence of true disruption ### Statistical Methods Used **Robust Regression (`MASS::rlm`)**: - Uses iteratively reweighted least squares (IRLS) - Minimizes influence of outliers and extreme values - More resistant to model misspecification than ordinary least squares - Default: Huber weighting with maximum 100 iterations **MAD (Median Absolute Deviation)**: - Robust measure of scale/variability - Formula: `MAD = median(|x - median(x)|)` - More resistant to outliers than standard deviation - Used to standardize residuals for anomaly detection **Panel Regression (`fixest::feols`)**: - Fixed-effects estimation with clustered standard errors - Accounts for within-group correlation in errors - More efficient than traditional panel regression packages - Handles unbalanced panels gracefully **Geographic Clustering**: - Regressions use clustered standard errors at the lowest available geographic level - This accounts for within-area correlation in service delivery patterns - Example: Country-wide model clusters by district, province model clusters by district - Prevents underestimation of standard errors and false positives </details> <details> <summary><strong>Detailed Analysis Steps</strong></summary> ### PART 1 - Control Chart Analysis #### Step 1: Prepare the Data - Load raw HMIS service utilization data. - Merge in outlier flags (`outlier_flag`) by facility × indicator × month. - Remove rows flagged as outliers (`outlier_flag == 1`). - Create a `date` variable from `period_id` and extract `year` and `month`. - Create a unique `panelvar` for each geographic area-indicator combination. - Aggregate data to the specified geographic level by summing `count_model` (based on `SELECTEDCOUNT`) by date. - Fill in missing months within each panel to ensure continuity. - Fill missing metadata using forward and backward fill. #### Step 2: Filter Out Low-Volume Months - Compute the global mean service volume for each `panelvar`. - If `count_original` is <50% of the global mean, drop the value by setting it to `NA`. #### Step 3: Apply Regression and Smoothing Estimate expected service volume using robust regression, then smooth the predicted trend. - Fit robust regression (`rlm`) for each panel using one of three model specifications based on data availability. - Apply rolling median smoothing to predictions using window size `SMOOTH_K`. - If smoothing is not possible (e.g., at series edges), fallback to model predictions. - Calculate residuals: actual - smoothed - Standardize residuals using MAD This standardized control variable is used to detect anomalies in Step 4. #### Step 4: Tag Disruptions Apply rule-based tagging to identify potential disruptions. Each rule is governed by user-defined parameters that can be tuned for sensitivity: - **Sharp Disruptions**: Tag if `|robust_control| ≥ MADS_THRESHOLD` - **Sustained Drops**: Tag final month if 3 consecutive months have mild deviations and final month exceeds threshold - **Sustained Dips**: Tag entire sequence if `count_original < DIP_THRESHOLD × count_smooth` for 3+ months - **Sustained Rises**: Tag entire sequence if `count_original > RISE_THRESHOLD × count_smooth` for 3+ months - **Missing Data**: Tag if 2+ of past 3 months are missing or zero - **Recent Tail Override**: Automatically tag all months in last 6 months of data A month is assigned `tagged = 1` if any of the above conditions are met. Tagged records are saved in `M3_chartout.csv` and passed to the disruption analysis. ### PART 2 - Disruption Analysis #### Step 1: Data preparation - The `M3_chartout` dataset is merged with the main dataset to integrate the `tagged` variable, which identifies flagged disruptions. - The lowest available geographic level (`lowest_geo_level`) is identified for clustering, based on the highest-resolution `admin_area_*` column available. #### Step 2: Country-wide regression For each `indicator_common_id`, estimate the national-level model with errors clustered at district level. - A panel regression model is applied at the country-wide level, estimating the expected service volume (`expect_admin_area_1`) for each indicator. - The model adjusts for historical trends and seasonal variations. - If a disruption (`tagged` = 1) is detected, the predicted service volume is adjusted by subtracting the estimated effect of the disruption to isolate its impact. #### Step 3: Province-level regression For each `indicator_common_id` × `admin_area_2` combination, estimate province-specific models with errors clustered at district level. - A fixed effects panel regression model is applied at the province level, estimating expected service volume (`expect_admin_area_2`) while controlling for province-specific factors. - The model adjusts for historical trends and seasonal variations. - If a disruption is detected, predicted volumes are adjusted to isolate the impact. #### Step 4: District-level regression (if enabled) For each `indicator_common_id` × `admin_area_3` combination, estimate district-specific models with errors clustered at ward level. - A fixed effects panel regression model is applied at the district level, estimating expected service volume (`expect_admin_area_3`). - The model adjusts for historical trends and seasonal variations. - If a disruption is detected, predicted volumes are adjusted to isolate the impact. #### Step 5: Prepare Outputs for Visualization Once expected values have been calculated for each level (country, province, district), the pipeline compares predicted and actual values to assess the magnitude of disruption. For each month and indicator, the pipeline calculates: - **Absolute and percentage difference** between predicted and actual values: $$ \text{diff\_percent} = 100 \times \frac{\text{predicted} - \text{actual}}{\text{predicted}} $$ - A configurable threshold parameter `DIFFPERCENT` (default: `10`) is used to determine when a disruption is significant. If the percentage difference exceeds ±10%, the expected (predicted) value is retained and used for plotting and summary statistics. Otherwise, the actual observed value is used. This ensures that minor fluctuations do not lead to artificial disruptions in the visualization, while meaningful deviations are preserved. - The final adjusted value for plotting is stored in a field such as `count_expected_if_above_diff_threshold`. This value reflects either: - The predicted count (if deviation > threshold), or - The actual count (if within acceptable range). This logic is applied consistently across all admin levels. These adjusted values are then exported as part of the final output files for each level. </details> <details> <summary><strong>Code Examples</strong></summary> ### Basic Execution <div class="language-r highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Set working directory</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=nf>setwd</span><span class=p>(</span><span class=s>&quot;/path/to/project&quot;</span><span class=p>)</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=c1># Ensure Module 1 and 2 outputs exist</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=nf>stopifnot</span><span class=p>(</span><span class=nf>file.exists</span><span class=p>(</span><span class=s>&quot;M1_output_outliers.csv&quot;</span><span class=p>))</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=nf>stopifnot</span><span class=p>(</span><span class=nf>file.exists</span><span class=p>(</span><span class=s>&quot;M2_adjusted_data.csv&quot;</span><span class=p>))</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=c1># Run Module 3</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=nf>source</span><span class=p>(</span><span class=s>&quot;03_module_service_utilization.R&quot;</span><span class=p>)</span>
</span></code></pre></div> ### Example Use Case 1: National COVID-19 Impact Assessment **Objective**: Quantify disruptions in maternal health services during pandemic **Configuration**: <div class="language-r highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>SELECTEDCOUNT</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=s>&quot;count_final_both&quot;</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=n>MADS_THRESHOLD</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>1.5</span><span class=w>  </span><span class=c1># Standard sensitivity</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=n>DIP_THRESHOLD</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.90</span><span class=w>  </span><span class=c1># Flag 10% drops</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=n>RUN_DISTRICT_MODEL</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kc>TRUE</span><span class=w>  </span><span class=c1># District-level estimates</span>
</span></code></pre></div> **Analysis Approach**: 1. Run control chart to identify disrupted months 2. Examine `M3_chartout.csv` for temporal patterns 3. Use `M3_all_indicators_shortfalls_admin_area_1.csv` for national summary 4. Use `M3_all_indicators_shortfalls_admin_area_3.csv` for district hotspots **Expected Outputs**: - Sharp disruptions during lockdown months - Sustained dips in antenatal care, deliveries - Possible sustained rises in missed appointments ### Example Use Case 2: Routine Monitoring Dashboard **Objective**: Monthly monitoring of all health services for early warning **Configuration**: <div class="language-r highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=n>SELECTEDCOUNT</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=s>&quot;count_final_completeness&quot;</span><span class=w>  </span><span class=c1># Adjust for reporting gaps</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=n>MADS_THRESHOLD</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>1.0</span><span class=w>  </span><span class=c1># High sensitivity</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=n>DIP_THRESHOLD</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.95</span><span class=w>  </span><span class=c1># Flag even small drops (5%)</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=n>RUN_DISTRICT_MODEL</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kc>FALSE</span><span class=w>  </span><span class=c1># Faster runtime for frequent updates</span>
</span></code></pre></div> **Analysis Approach**: 1. Run monthly after new data available 2. Filter `M3_chartout.csv` for `tagged == 1` in recent months 3. Investigate flagged indicator-geography combinations 4. Generate automated alerts for stakeholders **Expected Outputs**: - Early detection of emerging disruptions - Timely identification of data quality issues - Geographic targeting for supportive supervision ### Example Use Case 3: Post-Conflict Recovery Assessment **Objective**: Assess recovery of health services after conflict ends **Configuration**: <div class="language-r highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=n>SELECTEDCOUNT</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=s>&quot;count_final_both&quot;</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=n>MADS_THRESHOLD</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>2.0</span><span class=w>  </span><span class=c1># Conservative (major disruptions only)</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=n>DIP_THRESHOLD</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.80</span><span class=w>  </span><span class=c1># Flag 20% drops</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=n>SMOOTH_K</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>11</span><span class=w>  </span><span class=c1># Heavy smoothing to identify stable trends</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=n>RUN_DISTRICT_MODEL</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kc>TRUE</span><span class=w>  </span><span class=c1># District-level for targeted support</span>
</span></code></pre></div> **Analysis Approach**: 1. Focus on post-conflict period in outputs 2. Compare `count_sum` to `count_expect_sum` over time 3. Track `shortfall_percent` trends toward zero (recovery) 4. Identify districts with persistent disruptions **Expected Outputs**: - Quantified service volume gaps during conflict - Recovery trajectories by service type - Geographic prioritization for rebuilding efforts </details> <details> <summary><strong>Troubleshooting</strong></summary> ### Common Issues and Solutions **Issue**: Script crashes with "out of memory" error **Solutions**: - Reduce batch sizes (e.g., `BATCH_SIZE_IND <- 3`) - Set `RUN_DISTRICT_MODEL <- FALSE` - Set `RUN_ADMIN_AREA_4_ANALYSIS <- FALSE` - Close other applications - Run on machine with more RAM --- **Issue**: Warning "model failed to converge" **Explanation**: Robust regression didn't fully converge within 100 iterations **Impact**: Usually minimal - partial convergence often sufficient **Solutions**: - Check data quality for that panel - Increase `maxit` parameter in `rlm()` call (line 229, 247) - Generally safe to ignore if only a few panels affected --- **Issue**: Many empty rows in output files **Explanation**: Insufficient data for certain indicator-geography combinations **Solutions**: - Expected behavior for sparse indicators - Filter outputs to non-missing values - Consider aggregating to higher geographic level --- **Issue**: All recent months flagged as disruptions **Explanation**: Automatic flagging of last 6 months **Purpose**: Ensures recent trends reviewed even without strong statistical evidence **Solutions**: - Expected behavior, not a bug - Review recent months manually - Adjust `last_6_months` logic if needed (line 333) --- **Issue**: `tagged` variable dropped from regression **Message**: Variable automatically set to 0 **Explanation**: No variation in `tagged` within that panel (all 0 or all 1) **Solutions**: - Expected in panels with no disruptions or constant disruption - Not an error - disruption effect correctly set to 0 --- **Issue**: Temporary files remain after run **Cause**: Script crashed before cleanup **Solutions**: - Delete manually: `M3_temp_*.csv` - Or re-run script (automatic cleanup at start) --- **Issue**: Very different results at different geographic levels **Explanation**: Different geographic aggregation captures different patterns **Example**: National trend may be stable while some districts have large disruptions **Solutions**: - Expected behavior - not a bug - Use appropriate level for your research question - Cross-check patterns across levels for robustness </details> <details> <summary><strong>Usage Notes</strong></summary> ### Interpretation Guidelines **Disruption Effects (b_admin_area_*)**: - Negative values indicate service volume shortfalls during disrupted periods - Positive values indicate service volume surpluses during disrupted periods - Values closer to zero indicate smaller disruption impacts **P-values (p_admin_area_*)**: - Values < 0.05 suggest statistically significant disruptions - Values > 0.05 may indicate normal variation rather than true disruptions **Trend Coefficients (b_trend_admin_area_*)**: - Positive values indicate increasing service utilization over time - Negative values indicate declining service utilization over time - Values near zero indicate stable utilization patterns ### Performance Considerations **Runtime Factors**: - **Number of indicators**: Linear scaling - **Number of geographic units**: Linear scaling within each level - **Time series length**: Minimal impact (efficient regression) - **Geographic detail**: Exponential scaling (many more units at finer levels) **Estimated Runtimes** (example dataset: 50 indicators, 100 districts): - Country-wide + Province models: ~5-10 minutes - Add District models: ~30-60 minutes - Add Ward models: Several hours (depends on number of wards) **Optimization Strategies**: - Set `RUN_DISTRICT_MODEL = FALSE` for faster execution (skips district level) - Set `RUN_ADMIN_AREA_4_ANALYSIS = FALSE` (default) to avoid ward-level analysis - Reduce `SMOOTH_K` for faster rolling median calculation - Use `SELECTEDCOUNT = "count_final_none"` to avoid completeness adjustments ### Data Processing Details **Memory Management**: - Uses `data.table` for efficient operations on large datasets - Batch processing: Results saved to disk periodically - Progressive cleanup: Objects deleted when no longer needed - Temporary files enable processing datasets larger than RAM **Batch Sizes** (tunable for memory constraints): - Control chart: 100 panels per batch - Indicators: 5 indicators per batch - Provinces: 20 results per batch - Districts: 15 results per batch - Admin area 4: 10 results per batch **Missing Data Handling**: 1. Missing months filled via `tidyr::complete()` 2. Forward/backward fill for metadata 3. Linear interpolation (`zoo::na.approx`) for count values 4. Maximum gap: Unlimited (rule = 2 extends endpoints) ### Model Fallback Logic The control chart analysis uses adaptive model selection based on data availability: **Full Model** (requires ≥12 obs AND >12 unique dates): <div class="language-r highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>count</span><span class=w> </span><span class=o>~</span><span class=w> </span><span class=n>month_factor</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nf>as.numeric</span><span class=p>(</span><span class=n>date</span><span class=p>)</span>
</span></code></pre></div> Accounts for both seasonality and linear trend **Trend-Only Model** (requires ≥12 obs): <div class="language-r highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>count</span><span class=w> </span><span class=o>~</span><span class=w> </span><span class=nf>as.numeric</span><span class=p>(</span><span class=n>date</span><span class=p>)</span>
</span></code></pre></div> Accounts for linear trend only (insufficient data for seasonality) **Median Fallback** (<12 observations): <div class="language-r highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>count_predict</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nf>median</span><span class=p>(</span><span class=n>count</span><span class=p>)</span>
</span></code></pre></div> Uses global median when insufficient data for regression **Convergence Checks**: - Models checked for convergence status - Warnings issued for non-convergent models - Non-convergent models still used (partial convergence often sufficient) ### Quality Assurance **Data Cleaning**: - Outliers removed prior to control chart analysis (based on Module 1 flags) - Low-volume months (<50% of mean) excluded to improve model stability - Predictions bounded at zero (counts cannot be negative) **Automatic Flagging**: - Recent months (last 6 months) automatically flagged to ensure current disruptions captured - Prevents missing ongoing disruptions due to insufficient deviation from trend **Robustness Checks**: - Model coefficients checked for `NA` values before use - If `tagged` variable dropped from model (no variation), disruption effect set to 0 - P-values calculated only when valid standard errors available **Edge Case Handling**: - Single-cluster panels: No clustering applied (would fail) - Insufficient data: Skip analysis for that panel/level - Missing predictions: Filled with original values where possible ### Workflow Integration This module is **Module 3** in the FASTR analytical pipeline: **Prerequisites**: 1. **Module 0**: Data preparation and harmonization 2. **Module 1**: Data Quality Assessment (generates `M1_output_outliers.csv`) 3. **Module 2**: Data Quality Adjustments (generates `M2_adjusted_data.csv`) **Downstream Modules**: 4. **Module 4**: Coverage Estimates (may use disruption flags) 5. **Module 5**: Visualization and reporting (uses all M3 outputs) ### Dependencies **R Packages Required**: - `data.table`: Efficient data manipulation - `lubridate`: Date handling - `zoo`: Rolling statistics and interpolation - `MASS`: Robust regression (rlm) - `fixest`: Fixed-effects panel regression - `dplyr`: Data manipulation - `tidyr`: Data tidying </details> <details> <summary><strong>References and Further Reading</strong></summary> **Statistical Process Control**: - Montgomery, D. C. (2009). *Introduction to Statistical Quality Control*. Wiley. - Shewhart, W. A. (1931). *Economic Control of Quality of Manufactured Product*. Van Nostrand. **Robust Regression**: - Huber, P. J. (1981). *Robust Statistics*. Wiley. - Maronna, R. A., Martin, R. D., & Yohai, V. J. (2006). *Robust Statistics: Theory and Methods*. Wiley. **Panel Data Methods**: - Wooldridge, J. M. (2010). *Econometric Analysis of Cross Section and Panel Data*. MIT Press. - Cameron, A. C., & Miller, D. L. (2015). "A Practitioner's Guide to Cluster-Robust Inference." *Journal of Human Resources*, 50(2), 317-372. **Health Service Disruptions**: - WHO (2020). *Pulse survey on continuity of essential health services during the COVID-19 pandemic*. - Arsenault, C., et al. (2022). "COVID-19 and resilience of healthcare systems in ten countries." *Nature Medicine*, 28, 1314-1324. </details> <hr> <p><strong>Last updated</strong>: 2025 January <strong>Module version</strong>: 3.0 <strong>Contact</strong>: FASTR Project Team</p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../02_module_data_quality_adjustments_documentation/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Module 2 · Data Quality Adjustments"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Module 2 · Data Quality Adjustments </div> </div> </a> <a href=../04_module_coverage_estimates_documentation/ class="md-footer__link md-footer__link--next" aria-label="Next: Module 4 · Coverage Estimates"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Module 4 · Coverage Estimates </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 FASTR Methodology Documentation </div> </div> <div class=md-social> <a href=/ target=_blank rel=noopener title=Home class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M277.8 8.6c-12.3-11.4-31.3-11.4-43.5 0l-224 208c-9.6 9-12.8 22.9-8 35.1S18.8 272 32 272h16v176c0 35.3 28.7 64 64 64h288c35.3 0 64-28.7 64-64V272h16c13.2 0 25-8.1 29.8-20.3s1.6-26.2-8-35.1zM240 320h32c26.5 0 48 21.5 48 48v96H192v-96c0-26.5 21.5-48 48-48"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.footer", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link", "content.tooltips"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>
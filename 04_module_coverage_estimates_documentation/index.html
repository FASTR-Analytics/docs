<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation for the Background chapter and four FASTR modules."><link href=../03_module_service_utilization_documentation/ rel=prev><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.23"><title>Module 4 · Coverage Estimates - FASTR Methodology</title><link rel=stylesheet href=../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../stylesheets/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=teal> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#module-4-coverage-estimates class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="FASTR Methodology" class="md-header__button md-logo" aria-label="FASTR Methodology" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> FASTR Methodology </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Module 4 · Coverage Estimates </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Overview </a> </li> <li class=md-tabs__item> <a href=../00_background_documentation/ class=md-tabs__link> Background </a> </li> <li class=md-tabs__item> <a href=../01_module_data_quality_assessment_documentation/ class=md-tabs__link> Module 1 · Data Quality Assessment </a> </li> <li class=md-tabs__item> <a href=../02_module_data_quality_adjustments_documentation/ class=md-tabs__link> Module 2 · Data Quality Adjustments </a> </li> <li class=md-tabs__item> <a href=../03_module_service_utilization_documentation/ class=md-tabs__link> Module 3 · Service Utilization </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Module 4 · Coverage Estimates </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="FASTR Methodology" class="md-nav__button md-logo" aria-label="FASTR Methodology" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg> </a> FASTR Methodology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../00_background_documentation/ class=md-nav__link> <span class=md-ellipsis> Background </span> </a> </li> <li class=md-nav__item> <a href=../01_module_data_quality_assessment_documentation/ class=md-nav__link> <span class=md-ellipsis> Module 1 · Data Quality Assessment </span> </a> </li> <li class=md-nav__item> <a href=../02_module_data_quality_adjustments_documentation/ class=md-nav__link> <span class=md-ellipsis> Module 2 · Data Quality Adjustments </span> </a> </li> <li class=md-nav__item> <a href=../03_module_service_utilization_documentation/ class=md-nav__link> <span class=md-ellipsis> Module 3 · Service Utilization </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Module 4 · Coverage Estimates </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Module 4 · Coverage Estimates </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-overview-what-why class=md-nav__link> <span class=md-ellipsis> 1. Overview (What &amp; Why) </span> </a> <nav class=md-nav aria-label="1. Overview (What & Why)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-does-this-module-do class=md-nav__link> <span class=md-ellipsis> What does this module do? </span> </a> </li> <li class=md-nav__item> <a href=#why-is-it-needed-in-the-fastr-pipeline class=md-nav__link> <span class=md-ellipsis> Why is it needed in the FASTR pipeline? </span> </a> </li> <li class=md-nav__item> <a href=#quick-summary class=md-nav__link> <span class=md-ellipsis> Quick Summary </span> </a> </li> <li class=md-nav__item> <a href=#part-1-and-part-2-explained class=md-nav__link> <span class=md-ellipsis> Part 1 and Part 2 Explained </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-how-it-works class=md-nav__link> <span class=md-ellipsis> 2. How It Works </span> </a> <nav class=md-nav aria-label="2. How It Works"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#high-level-workflow class=md-nav__link> <span class=md-ellipsis> High-Level Workflow </span> </a> </li> <li class=md-nav__item> <a href=#visual-workflow-diagram class=md-nav__link> <span class=md-ellipsis> Visual Workflow Diagram </span> </a> </li> <li class=md-nav__item> <a href=#key-decision-points class=md-nav__link> <span class=md-ellipsis> Key Decision Points </span> </a> </li> <li class=md-nav__item> <a href=#what-happens-to-the-data class=md-nav__link> <span class=md-ellipsis> What Happens to the Data </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-detailed-reference class=md-nav__link> <span class=md-ellipsis> 3. Detailed Reference </span> </a> <nav class=md-nav aria-label="3. Detailed Reference"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#part-1-denominator-calculation-technical-details class=md-nav__link> <span class=md-ellipsis> Part 1: Denominator Calculation (Technical Details) </span> </a> </li> <li class=md-nav__item> <a href=#part-2-denominator-selection-projection-technical-details class=md-nav__link> <span class=md-ellipsis> Part 2: Denominator Selection &amp; Projection (Technical Details) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=module-4-coverage-estimates>Module 4: Coverage Estimates<a class=headerlink href=#module-4-coverage-estimates title="Anchor link to this section">&para;</a></h1> <h2 id=1-overview-what-why>1. Overview (What &amp; Why)<a class=headerlink href=#1-overview-what-why title="Anchor link to this section">&para;</a></h2> <h3 id=what-does-this-module-do>What does this module do?<a class=headerlink href=#what-does-this-module-do title="Anchor link to this section">&para;</a></h3> <p>This module estimates health service coverage by integrating three key data sources: adjusted health service volumes from HMIS (Module 2), population projections from the United Nations, and household survey data from MICS/DHS. It answers the fundamental question: "What percentage of the target population received this health service?"</p> <p>The module operates in two distinct parts. <strong>Part 1</strong> calculates target population sizes (denominators) using multiple methods and automatically selects the best option for each health indicator by comparing results against survey benchmarks. <strong>Part 2</strong> allows users to refine these selections, choose specific denominators based on programmatic knowledge, and project survey estimates forward in time using administrative data trends to fill gaps where surveys are unavailable.</p> <p>Together, these parts transform raw service counts into meaningful coverage estimates that can be analyzed for trends, compared across regions, and used for policy decisions.</p> <h3 id=why-is-it-needed-in-the-fastr-pipeline>Why is it needed in the FASTR pipeline?<a class=headerlink href=#why-is-it-needed-in-the-fastr-pipeline title="Anchor link to this section">&para;</a></h3> <p>Understanding coverage is essential for monitoring health system performance and equity. While Module 2 provides adjusted service volumes, these numbers alone don't tell us whether services are reaching their intended populations. Coverage estimates provide context by comparing service delivery to population need.</p> <p>This module addresses key challenges in coverage estimation: - <strong>Multiple data sources</strong>: Integrates HMIS data (continuous but may have quality issues) with survey data (high quality but infrequent) - <strong>Denominator uncertainty</strong>: Different methods for estimating target populations may yield different results; the module systematically evaluates options - <strong>Temporal gaps</strong>: Surveys occur every 3-5 years; the module projects estimates for intervening years using administrative trends - <strong>Subnational analysis</strong>: Enables coverage monitoring at national, provincial, and district levels</p> <h3 id=quick-summary>Quick Summary<a class=headerlink href=#quick-summary title="Anchor link to this section">&para;</a></h3> <table> <thead> <tr> <th>Component</th> <th>Details</th> </tr> </thead> <tbody> <tr> <td><strong>Inputs</strong></td> <td>M2_adjusted_data (national &amp; subnational) from Module 2<br>Survey data (MICS/DHS) from GitHub repository<br>Population data (UN WPP) from GitHub repository</td> </tr> <tr> <td><strong>Outputs</strong></td> <td>M4_denominators (national, admin2, admin3) - calculated target populations<br>M4_combined_results (national, admin2, admin3) - coverage estimates with all denominators<br>M5_coverage_estimation (national, admin2, admin3) - final coverage with projections</td> </tr> <tr> <td><strong>Purpose</strong></td> <td>Estimate health service coverage by comparing service volumes to target populations, validated against survey benchmarks</td> </tr> </tbody> </table> <h3 id=part-1-and-part-2-explained>Part 1 and Part 2 Explained<a class=headerlink href=#part-1-and-part-2-explained title="Anchor link to this section">&para;</a></h3> <p><strong>Part 1: Denominator Calculation and Selection</strong> - Calculates target populations (denominators) using multiple approaches: HMIS-based (from ANC1, delivery, BCG, Penta1) and population-based (UN WPP) - Compares coverage estimates from each denominator against survey data - Automatically selects the "best" denominator for each indicator by minimizing error - Outputs: Denominator datasets and combined results showing all options</p> <p><strong>Part 2: Denominator Selection and Survey Projection</strong> - Allows users to override automatic selections and choose specific denominators - Calculates year-over-year coverage trends from administrative data - Projects survey estimates forward using HMIS trends to fill temporal gaps - Outputs: Final coverage estimates combining HMIS, survey, and projected values</p> <hr> <h2 id=2-how-it-works>2. How It Works<a class=headerlink href=#2-how-it-works title="Anchor link to this section">&para;</a></h2> <h3 id=high-level-workflow>High-Level Workflow<a class=headerlink href=#high-level-workflow title="Anchor link to this section">&para;</a></h3> <h4 id=part-1-denominator-calculation-and-selection>Part 1: Denominator Calculation and Selection<a class=headerlink href=#part-1-denominator-calculation-and-selection title="Anchor link to this section">&para;</a></h4> <p><strong>Step 1: Load and Prepare Data Sources</strong> The module begins by loading three data sources and ensuring they're compatible. HMIS data is aggregated from monthly to annual totals. Survey data is harmonized (DHS prioritized over MICS) and forward-filled to create continuous time series. Population data is filtered to the target country.</p> <p><strong>Step 2: Calculate Multiple Denominator Options</strong> For each health indicator, the module calculates several possible target populations: - <strong>Service-based denominators</strong>: Using HMIS volumes divided by survey coverage (e.g., if 10,000 women received ANC1 and survey says coverage is 80%, estimated pregnancies = 10,000/0.80 = 12,500) - <strong>Population-based denominators</strong>: Using UN population projections and birth rates - Each denominator is adjusted for demographic factors (pregnancy loss, stillbirths, mortality rates) to match the indicator's target age group</p> <p><strong>Step 3: Calculate Coverage for Each Denominator</strong> The module computes coverage by dividing the service volume by each denominator option. This produces multiple coverage estimates per indicator, each based on a different population assumption.</p> <p><strong>Step 4: Compare to Survey Benchmarks</strong> Each coverage estimate is compared to survey data using squared error calculation. The survey serves as the "truth" benchmark since it's based on representative household sampling.</p> <p><strong>Step 5: Select the Best Denominator</strong> The denominator producing the lowest error (closest match to survey) is automatically selected as "best." The selection prioritizes HMIS-based denominators over population projections to ensure data is driven by observed service delivery.</p> <p><strong>Step 6: Generate Outputs</strong> The module saves denominator datasets for transparency and combined results files showing coverage from all denominators plus the selected best option.</p> <p><strong>Step 7: Repeat for Subnational Levels</strong> If subnational data is available, the process repeats for administrative level 2 (e.g., provinces) and level 3 (e.g., districts), with fallback mechanisms to handle missing local survey data.</p> <h4 id=part-2-denominator-selection-and-survey-projection>Part 2: Denominator Selection and Survey Projection<a class=headerlink href=#part-2-denominator-selection-and-survey-projection title="Anchor link to this section">&para;</a></h4> <p><strong>Step 1: User Configuration</strong> Users review Part 1 results and configure denominator selections for each indicator. Options include using the automatic "best" selection or overriding with a specific denominator based on programmatic knowledge.</p> <p><strong>Step 2: Filter to Selected Denominators</strong> The module filters Part 1's combined results to include only user-selected denominators, creating a focused dataset for analysis.</p> <p><strong>Step 3: Calculate Coverage Trends</strong> Year-over-year changes (deltas) in HMIS-based coverage are calculated. This shows whether coverage is increasing, decreasing, or stable over time.</p> <p><strong>Step 4: Identify Survey Baseline</strong> For each geographic area and indicator, the most recent survey observation is identified as the baseline anchor point for projections.</p> <p><strong>Step 5: Project Survey Estimates Forward</strong> The module extends survey coverage estimates into years without surveys by applying HMIS trends. The projection uses: Last survey value + (Current year HMIS coverage - Survey year HMIS coverage). This preserves the survey calibration while incorporating observed trends.</p> <p><strong>Step 6: Combine All Estimates</strong> The final output merges three types of estimates: - <strong>HMIS-based coverage</strong>: Direct calculation from service volumes and selected denominators - <strong>Original survey values</strong>: Actual household survey observations - <strong>Projected survey coverage</strong>: Survey estimates extended using HMIS trends</p> <p><strong>Step 7: Save Final Outputs</strong> Results are saved with standardized column structures for each administrative level, ready for visualization and reporting.</p> <h3 id=visual-workflow-diagram>Visual Workflow Diagram<a class=headerlink href=#visual-workflow-diagram title="Anchor link to this section">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>┌─────────────────────────────────────────────────────────────────┐
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>│                         PART 1: DENOMINATOR                      │
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>│                    CALCULATION AND SELECTION                     │
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>└─────────────────────────────────────────────────────────────────┘
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>  ┌──────────────┐     ┌──────────────┐     ┌──────────────┐
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>  │ HMIS Data    │     │ Survey Data  │     │ Population   │
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>  │ (Module 2)   │     │ (MICS/DHS)   │     │ Data (UN WPP)│
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>  └──────┬───────┘     └──────┬───────┘     └──────┬───────┘
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>         │                    │                    │
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>         ▼                    ▼                    ▼
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>  ┌─────────────────────────────────────────────────────┐
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>  │          Process and Harmonize Data                 │
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>  │  • Aggregate monthly → annual                       │
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>  │  • Prioritize DHS over MICS                         │
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>  │  • Forward-fill survey gaps                         │
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>  │  • Filter population to country                     │
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>  └─────────────────────┬───────────────────────────────┘
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>                        │
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>                        ▼
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>  │      Calculate Multiple Denominator Options          │
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>  │                                                       │
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>  │  HMIS-Based:              Population-Based:          │
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>  │  • From ANC1              • From birth rate          │
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>  │  • From Delivery          • From total population    │
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>  │  • From SBA               • From under-1 population  │
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>  │  • From BCG                                          │
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>  │  • From Penta1                                       │
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a>  │                                                       │
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>  │  [Apply demographic adjustments to each]             │
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>                        │
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>                        ▼
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a>  │   Calculate Coverage for Each Denominator            │
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a>  │   Coverage = (Service Volume / Denominator) × 100    │
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a>                        │
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a>                        ▼
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a>  │      Compare Each Coverage to Survey Benchmark       │
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a>  │      Error = (HMIS Coverage - Survey Coverage)²      │
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a>                        │
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a>                        ▼
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a>  │         Select Best Denominator                      │
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a>  │         (Minimum error, prefer HMIS-based)           │
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a>                        │
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a>                        ▼
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a>  │                Save Outputs                          │
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a>  │  • M4_denominators (all options)                     │
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a>  │  • M4_combined_results (coverage + best selection)   │
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a>                        │
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59 href=#__codelineno-0-59></a>                        │
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60 href=#__codelineno-0-60></a>┌───────────────────────┼──────────────────────────────────────────┐
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61 href=#__codelineno-0-61></a>│                       ▼              PART 2: DENOMINATOR         │
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62 href=#__codelineno-0-62></a>│                                  SELECTION AND PROJECTION        │
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63 href=#__codelineno-0-63></a>└──────────────────────────────────────────────────────────────────┘
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64 href=#__codelineno-0-64></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65 href=#__codelineno-0-65></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66 href=#__codelineno-0-66></a>  │          User Configures Denominator Selection       │
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67 href=#__codelineno-0-67></a>  │          (Use &quot;best&quot; or specify for each indicator)  │
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68 href=#__codelineno-0-68></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69 href=#__codelineno-0-69></a>                        │
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70 href=#__codelineno-0-70></a>                        ▼
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71 href=#__codelineno-0-71></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72 href=#__codelineno-0-72></a>  │      Filter Part 1 Results to Selected Denominators  │
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73 href=#__codelineno-0-73></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74 href=#__codelineno-0-74></a>                        │
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75 href=#__codelineno-0-75></a>                        ▼
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76 href=#__codelineno-0-76></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77 href=#__codelineno-0-77></a>  │         Calculate Year-Over-Year Coverage Deltas     │
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78 href=#__codelineno-0-78></a>  │         Δ Coverage = Coverage(t) - Coverage(t-1)     │
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79 href=#__codelineno-0-79></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80 href=#__codelineno-0-80></a>                        │
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81 href=#__codelineno-0-81></a>                        ▼
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82 href=#__codelineno-0-82></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83 href=#__codelineno-0-83></a>  │    Identify Most Recent Survey as Baseline           │
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84 href=#__codelineno-0-84></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85 href=#__codelineno-0-85></a>                        │
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86 href=#__codelineno-0-86></a>                        ▼
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87 href=#__codelineno-0-87></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88 href=#__codelineno-0-88></a>  │         Project Survey Estimates Forward             │
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89 href=#__codelineno-0-89></a>  │  Projection = Last Survey + (HMIS_now - HMIS_then)  │
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90 href=#__codelineno-0-90></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91 href=#__codelineno-0-91></a>                        │
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92 href=#__codelineno-0-92></a>                        ▼
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93 href=#__codelineno-0-93></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94 href=#__codelineno-0-94></a>  │              Combine Final Results                   │
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95 href=#__codelineno-0-95></a>  │  • HMIS-based coverage                               │
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96 href=#__codelineno-0-96></a>  │  • Original survey values                            │
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97 href=#__codelineno-0-97></a>  │  • Projected survey coverage                         │
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98 href=#__codelineno-0-98></a>  └─────────────────────┬────────────────────────────────┘
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99 href=#__codelineno-0-99></a>                        │
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100 href=#__codelineno-0-100></a>                        ▼
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101 href=#__codelineno-0-101></a>  ┌──────────────────────────────────────────────────────┐
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102 href=#__codelineno-0-102></a>  │                Save Final Outputs                    │
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103 href=#__codelineno-0-103></a>  │        M5_coverage_estimation (by admin level)       │
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104 href=#__codelineno-0-104></a>  └──────────────────────────────────────────────────────┘
</span></code></pre></div> <h3 id=key-decision-points>Key Decision Points<a class=headerlink href=#key-decision-points title="Anchor link to this section">&para;</a></h3> <p><strong>1. Which denominator to use?</strong> Part 1 automatically selects based on alignment with survey data, but users can override in Part 2. The choice affects whether coverage is anchored to service delivery patterns (HMIS-based) or demographic projections (population-based).</p> <p><strong>2. How to handle survey gaps?</strong> Surveys occur infrequently (every 3-5 years). The module forward-fills survey values in Part 1 (assumes constant coverage until next survey) and uses projection in Part 2 (incorporates HMIS trends).</p> <p><strong>3. Should subnational analysis use local or national survey data?</strong> When local survey data is unavailable, the module falls back to national values. This assumes national coverage rates apply locally, which may not hold in all contexts.</p> <p><strong>4. How to adjust denominators for different target populations?</strong> Each health indicator targets a specific population (e.g., pregnant women for ANC, infants for vaccines). The module applies sequential demographic adjustments (pregnancy loss, stillbirths, mortality) to align denominators with target populations.</p> <h3 id=what-happens-to-the-data>What Happens to the Data<a class=headerlink href=#what-happens-to-the-data title="Anchor link to this section">&para;</a></h3> <p>The transformation flow:</p> <p><strong>Input:</strong> Monthly service counts by facility → <strong>Aggregate</strong> → Annual service volumes by area</p> <p><strong>Input:</strong> Survey observations (scattered years) → <strong>Harmonize &amp; forward-fill</strong> → Continuous coverage time series</p> <p><strong>Input:</strong> Population projections → <strong>Filter &amp; extract</strong> → Target population estimates</p> <p><strong>Combine:</strong> Service volumes ÷ Survey coverage → <strong>Calculate</strong> → HMIS-based denominators</p> <p><strong>Combine:</strong> Service volumes ÷ Each denominator → <strong>Calculate</strong> → Multiple coverage estimates</p> <p><strong>Compare:</strong> Coverage estimates vs. Survey benchmarks → <strong>Select</strong> → Best denominator per indicator</p> <p><strong>Project:</strong> Last survey + HMIS trends → <strong>Extend</strong> → Coverage estimates for all years</p> <p><strong>Output:</strong> Comprehensive dataset with HMIS coverage, survey values, projections, and metadata</p> <hr> <h2 id=3-detailed-reference>3. Detailed Reference<a class=headerlink href=#3-detailed-reference title="Anchor link to this section">&para;</a></h2> <h3 id=part-1-denominator-calculation-technical-details>Part 1: Denominator Calculation (Technical Details)<a class=headerlink href=#part-1-denominator-calculation-technical-details title="Anchor link to this section">&para;</a></h3> <details> <summary><strong>Configuration Parameters</strong></summary> The module begins with several configurable parameters that control the analysis: <div class="language-r highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>COUNTRY_ISO3</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=s>&quot;AFG&quot;</span><span class=w>                          </span><span class=c1># ISO3 country code</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>SELECTED_COUNT_VARIABLE</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=s>&quot;count_final_both&quot;</span><span class=w>  </span><span class=c1># Which adjusted count to use</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>ANALYSIS_LEVEL</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=s>&quot;NATIONAL_PLUS_AA2&quot;</span><span class=w>          </span><span class=c1># Geographic scope</span>
</span></code></pre></div> **Analysis Level Options:** - `NATIONAL_ONLY`: National-level analysis only - `NATIONAL_PLUS_AA2`: National + administrative area 2 (e.g., provinces) - `NATIONAL_PLUS_AA2_AA3`: National + admin area 2 + admin area 3 (e.g., districts) **Demographic Adjustment Rates:** <div class="language-r highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>PREGNANCY_LOSS_RATE</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.03</span><span class=w>      </span><span class=c1># 3% pregnancy loss</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>TWIN_RATE</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.015</span><span class=w>               </span><span class=c1># 1.5% twin births</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>STILLBIRTH_RATE</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.02</span><span class=w>          </span><span class=c1># 2% stillbirths</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=n>P1_NMR</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.039</span><span class=w>                  </span><span class=c1># Neonatal mortality rate</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=n>P2_PNMR</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.028</span><span class=w>                 </span><span class=c1># Post-neonatal mortality rate</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=n>INFANT_MORTALITY_RATE</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.063</span><span class=w>   </span><span class=c1># Infant mortality rate</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=n>UNDER5_MORTALITY_RATE</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=m>0.103</span><span class=w>   </span><span class=c1># Under-5 mortality rate</span>
</span></code></pre></div> **Count Variable Options:** - `count_final_none`: No adjustments (raw reported data) - `count_final_outlier`: Outlier adjustment only - `count_final_completeness`: Completeness adjustment only - `count_final_both`: Both adjustments **(recommended)** </details> <details> <summary><strong>Input Data Sources</strong></summary> Part 1 integrates three primary data sources: **1. HMIS Adjusted Data** (from Module 2) - National: `M2_adjusted_data_national.csv` - Subnational: `M2_adjusted_data_admin_area.csv` - Contains service volumes by indicator, area, and time period **2. Survey Data** (DHS/MICS) - Source: GitHub repository (unified survey dataset) - Provides coverage benchmarks for comparison - DHS data prioritized over MICS when both available **3. Population Data** (UN WPP) - Source: GitHub repository - Provides population-based denominators - Includes total population, births, under-1, and under-5 populations **Additional Data Context:** **Population Projections (UN WPP)** Sourced from the United Nations World Population Prospects, these estimates provide age-specific and total population figures used to calculate denominators for coverage estimates. These projections account for demographic trends, including fertility, mortality, and migration. **Survey Data - MICS** The Multiple Indicator Cluster Surveys (MICS), conducted by UNICEF, provide household survey-based estimates for key health indicators, including coverage of maternal and child health services. **Survey Data - DHS** The Demographic and Health Surveys (DHS), conducted by USAID, provide survey data on health service utilization, including immunization rates and maternal care coverage. </details> <details> <summary><strong>Core Functions Documentation</strong></summary> #### 1. `process_hmis_adjusted_volume()` **Purpose**: Prepares HMIS data for denominator calculation **Input**: - Adjusted volume data from Module 2 - Selected count variable (e.g., `count_final_both`) **Processing**: - Aggregates monthly data to annual totals - Counts number of reporting months per year - Pivots data to wide format (one column per indicator) **Output**: - `annual_hmis`: Annual service counts by area and year - `hmis_countries`: List of countries in dataset - `hmis_iso3`: ISO3 code(s) present **Example Structure**: <div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>admin_area_1  admin_area_2  year  countanc1  countdelivery  ...  nummonth
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>Afghanistan   Kabul         2020  12500      10200          ...  12
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>Afghanistan   Kabul         2021  13000      10500          ...  11
</span></code></pre></div> #### 2. `process_survey_data()` **Purpose**: Harmonizes and extends survey data for use as coverage benchmarks **Input**: - Survey data (DHS/MICS) - HMIS country names and ISO3 codes - Optional national reference (for subnational fallback) **Key Processing Steps**: 1. **Harmonization** - Recodes indicator names (e.g., `polio1` → `opv1`, `vitamina` → `vitaminA`) - Normalizes source labels (`dhs`, `mics`) - Filters by country and date range 2. **Source Prioritization** - When both DHS and MICS exist for same year/area/indicator - DHS is selected preferentially - Preserves source details for transparency 3. **Fallback Logic** - If `sba` missing, uses `delivery` values - If `pnc1_mother` missing, uses `pnc1` values - Subnational areas use national values when local data unavailable (for BCG, Penta1, Penta3) 4. **Forward-Filling** - Creates complete time series for each area - Carries forward last observed value (`na.locf`) - Creates "carry" columns (e.g., `anc1carry`, `bcgcarry`) **Output**: - `carried`: Extended survey data with forward-filled values - `raw`: Raw survey observations (wide format) - `raw_long`: Raw survey observations (long format) with source details #### 3. `process_national_population_data()` **Purpose**: Prepares UN WPP population estimates for denominator calculation **Input**: - Population estimates (UN WPP) - HMIS country identifiers **Processing**: - Filters to national level and target country - Extracts key population indicators: - `crudebr_unwpp`: Crude birth rate - `poptot_unwpp`: Total population - `totu1pop_unwpp`: Under-1 population **Output**: - `wide`: Population indicators in wide format - `raw_long`: Population data in long format with source tracking #### 4. `calculate_denominators()` **Purpose**: Calculates all possible denominators from HMIS and population data This is the core function that generates multiple denominator estimates. **Input**: - `hmis_data`: Annual service counts - `survey_data`: Survey reference values (carried forward) - `population_data`: UN WPP estimates (national only) **Denominator Types Calculated**: **A. Service-Based Denominators** (using HMIS numerator ÷ survey coverage): 1. **From ANC1**: - `danc1_pregnancy`: Estimated pregnancies - `danc1_delivery`: Estimated deliveries - `danc1_birth`: Estimated births (live + stillbirths) - `danc1_livebirth`: Estimated live births - `danc1_dpt`: Eligible for DPT (adjusted for neonatal mortality) - `danc1_measles1`: Eligible for MCV1 - `danc1_measles2`: Eligible for MCV2 2. **From Delivery**: - `ddelivery_livebirth`, `ddelivery_birth`, `ddelivery_pregnancy` - `ddelivery_dpt`, `ddelivery_measles1`, `ddelivery_measles2` 3. **From SBA** (Skilled Birth Attendance): - Same structure as delivery denominators - `dsba_livebirth`, `dsba_birth`, `dsba_pregnancy` - `dsba_dpt`, `dsba_measles1`, `dsba_measles2` 4. **From BCG** (national only): - `dbcg_pregnancy`, `dbcg_livebirth`, `dbcg_dpt` 5. **From Penta1**: - `dpenta1_dpt`, `dpenta1_measles1`, `dpenta1_measles2` **B. Population-Based Denominators** (national only): - `dwpp_pregnancy`: From crude birth rate × total population ÷ (1 + twin rate) - `dwpp_livebirth`: From crude birth rate × total population - `dwpp_dpt`: Under-1 population - `dwpp_measles1`: Under-1 population adjusted for neonatal mortality - `dwpp_measles2`: Further adjusted for post-neonatal mortality **C. Vitamin A and Full Immunization**: For each livebirth denominator, additional denominators are automatically created: - `d*_vitaminA`: Livebirth × (1 - U5MR) × 4.5 (children 6-59 months) - `d*_fully_immunized`: Livebirth × (1 - IMR) **Adjustment for Incomplete Reporting**: When `nummonth < 12`, population-based denominators are scaled: <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>denominator_adjusted = denominator × (nummonth / 12)
</span></code></pre></div> **Output**: Data frame with all calculated denominators plus original HMIS and survey data #### 5. `classify_source_type()` **Purpose**: Categorizes denominators to prevent circular references **Logic**: - `reference_based`: Denominator calculated from same indicator (e.g., `danc1_pregnancy` for ANC1) - `unwpp_based`: Denominator from UN WPP population data - `independent`: Denominator from a different service indicator **Importance**: This classification ensures that when selecting "best" denominators, we avoid using reference-based denominators (which would artificially show 100% coverage equal to the survey value). #### 6. `compare_coverage_to_survey()` **Purpose**: Selects the best-performing denominator for each indicator **Input**: - Coverage estimates from all denominators - Survey reference values (forward-filled) **Selection Algorithm**: 1. **Calculate Coverage**: For each denominator option <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>coverage = (service_volume / denominator) × 100
</span></code></pre></div> 2. **Calculate Error**: Compare to survey benchmark <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>squared_error = (HMIS_coverage - survey_coverage)²
</span></code></pre></div> 3. **Classify Source Type**: Label each denominator as independent, reference-based, or UNWPP 4. **Selection Hierarchy**: <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>Priority 1: Independent denominators (non-reference, non-UNWPP) → lowest error
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>Priority 2: Reference-based denominators (only if no independent available)
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>Priority 3: UNWPP denominators (last resort fallback)
</span></code></pre></div> 5. **Geographic Consistency**: Best denominator selected per geographic area × indicator (not per year) **Output**: Coverage data filtered to only the best-performing denominator for each indicator, with ranking **Key Design Decision**: - UNWPP denominators excluded from "best" selection by default - Prevents over-reliance on population projections - Ensures HMIS data drives coverage when available - UNWPP used only when no HMIS-based options exist #### 7. `create_combined_results_table()` **Purpose**: Merges coverage estimates and survey observations into unified output **Input**: - Coverage comparison results (best denominator selected) - Raw survey observations - All coverage data (optional, includes all denominators) **Output Structure**: <div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>admin_area_1  year  indicator_common_id  denominator_best_or_survey  value
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>Afghanistan   2020  anc1                 best                        85.3
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>Afghanistan   2020  anc1                 survey                      84.2
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>Afghanistan   2020  anc1                 danc1_pregnancy             85.3
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>Afghanistan   2020  anc1                 dwpp_pregnancy              82.1
</span></code></pre></div> **Denominator Categories**: - `best`: Selected optimal denominator - `survey`: Actual survey observation - `d*_*`: Individual denominator results (all options) </details> <details> <summary><strong>Statistical Methods & Algorithms</strong></summary> #### Forward-Filling (Last Observation Carried Forward) Survey data typically has gaps (e.g., DHS every 5 years). To create continuous denominators: <div class="language-r highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nf>na.locf</span><span class=p>(</span><span class=n>survey_value</span><span class=p>,</span><span class=w> </span><span class=n>na.rm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>FALSE</span><span class=p>)</span>
</span></code></pre></div> **Example**: <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>Year:   2015  2016  2017  2018  2019  2020
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>Raw:    85.3  NA    NA    NA    87.2  NA
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>Filled: 85.3  85.3  85.3  85.3  87.2  87.2
</span></code></pre></div> This assumes coverage remains constant until next observation. #### Squared Error Minimization To select the best denominator: $$ \text{Best denominator} = \arg \min_d \sum_{t} (C_{d,t} - S_t)^2 $$ Where: - $C_{d,t}$ = Coverage using denominator $d$ in year $t$ - $S_t$ = Survey coverage in year $t$ - Summation is across all years with survey data #### Adjustment Factor Cascading Denominators are adjusted through sequential application of demographic factors: **Example: ANC1 → DPT denominator** <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>Base (pregnancies):     10,000
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>After pregnancy loss:   10,000 × (1 - 0.03) = 9,700
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>After twin adjustment:  9,700 × (1 - 0.015/2) = 9,627
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>After stillbirths:      9,627 × (1 - 0.02) = 9,435
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>After neonatal deaths:  9,435 × (1 - 0.039) = 9,067
</span></code></pre></div> Each adjustment reduces the denominator to reflect population losses at different life stages. #### HMIS-based Denominator Calculations **General Formula:** $$ \text{Denominator} = \frac{\text{Service volume}}{\text{Survey-based coverage} / 100} $$ **ANC1 Denominator** $$ d_{\text{anc1, pregnancy}} = \frac{\text{count}_{\text{anc1}}}{\text{coverage}_{\text{anc1}} / 100} $$ $$ d_{\text{anc1, livebirth}} = d_{\text{anc1, pregnancy}} \times (1 - \text{pregnancy loss rate}) \times (1 - \frac{\text{twin rate}}{2}) \times (1 - \text{stillbirth rate}) $$ $$ d_{\text{anc1, dpt}} = d_{\text{anc1, pregnancy}} \times (1 - \text{pregnancy loss rate}) \times (1 - \frac{\text{twin rate}}{2}) \times (1 - \text{stillbirth rate}) \times (1 - \text{neonatal mortality rate}) $$ $$ d_{\text{anc1, mcv}} = d_{\text{anc1, pregnancy}} \times (1 - \text{pregnancy loss rate}) \times (1 - \frac{\text{twin rate}}{2}) \times (1 - \text{stillbirth rate}) \times (1 - \text{infant mortality rate}) $$ **Delivery Denominator (Live Births)** $$ d_{\text{delivery, pregnancy}} = \frac{\text{count}_{\text{delivery}}}{\text{coverage}_{\text{delivery}} / 100} \times (1 - \text{pregnancy loss rate}) $$ $$ d_{\text{delivery, dpt}} = d_{\text{delivery, pregnancy}} \times (1 + \text{twin rate}) \times (1 - \text{stillbirth rate}) \times (1 - \text{neonatal mortality rate}) $$ $$ d_{\text{delivery, mcv}} = d_{\text{delivery, pregnancy}} \times (1 + \text{twin rate}) \times (1 - \text{stillbirth rate}) \times (1 - \text{infant mortality rate}) $$ **BCG Denominator** $$ d_{\text{bcg, pregnancy}} = \frac{\text{count}_{\text{bcg}}}{\text{coverage}_{\text{bcg}} / 100} \times (1 - \text{pregnancy loss rate}) \times (1 + \text{twin rate}) \times (1 - \text{stillbirth rate}) $$ $$ d_{\text{bcg, dpt}} = d_{\text{bcg, pregnancy}} \times (1 - \text{neonatal mortality rate}) $$ $$ d_{\text{bcg, mcv}} = d_{\text{bcg, pregnancy}} \times (1 - \text{neonatal mortality rate}) \times (1 - \text{post-neonatal mortality rate}) $$ **Penta1 Denominator** $$ d_{\text{penta1, pregnancy}} = \frac{\text{count}_{\text{penta1}}}{\text{coverage}_{\text{penta1}} / 100} \times (1 - \text{pregnancy loss rate}) \times (1 + \text{twin rate}) \times (1 - \text{stillbirth rate}) \times (1 - \text{neonatal mortality rate}) $$ $$ d_{\text{penta1, livebirth}} = d_{\text{penta1, pregnancy}} \times (1 - \text{stillbirth rate}) \times (1 - \text{neonatal mortality rate}) $$ $$ d_{\text{penta1, mcv}} = d_{\text{penta1, pregnancy}} \times (1 - \text{post-neonatal mortality rate}) $$ #### UNWPP-based Denominator Calculations Some denominators can also be derived from World Population Prospects (WPP) projections instead of service volumes. **Estimated Pregnancies Based on Crude Birth Rate (CBR) and Total Population** $$ d_{\text{wpp, pregnancy}} = \left( \frac{\text{CBR}}{1000} \right) \times \text{Total population} \times \frac{12}{\text{months reported}} $$ **Estimated Live Births** $$ d_{\text{wpp, livebirth}} = \text{Total live births from WPP} \times \frac{12}{\text{months reported}} $$ **Estimated Population Eligible for DPT1 (Under 1 Year)** $$ d_{\text{wpp, dpt}} = \text{Total under-1 population from WPP} \times \frac{12}{\text{months reported}} $$ **Estimated Population Eligible for MCV (Under 5 Years)** $$ d_{\text{wpp, mcv}} = \text{Total under-5 population from WPP} \times \frac{12}{\text{months reported}} $$ HMIS data can contain incomplete or partial reporting, where service volumes are only available for a subset of months in a given year. If fewer than 12 months of data are reported, directly using the raw count would underestimate the total number of pregnancies. To adjust for this, we scale the reported number up to a full year equivalent by applying the factor $\frac{12}{\text{months reported}}$. </details> <details> <summary><strong>Output Files Specification</strong></summary> Part 1 generates six CSV files: #### Denominator Files **1. M4_denominators_national.csv** **2. M4_denominators_admin2.csv** **3. M4_denominators_admin3.csv** **Structure**: <div class="language-text highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>admin_area_1, [admin_area_2/3], year, denominator, source_indicator, target_population, value
</span></code></pre></div> **Fields**: - `denominator`: Full denominator name (e.g., `danc1_livebirth`) - `source_indicator`: Service used (e.g., `source_anc1`, `source_wpp`) - `target_population`: Target group (e.g., `target_livebirth`, `target_dpt`) - `value`: Calculated denominator size #### Combined Results Files **4. M4_combined_results_national.csv** **5. M4_combined_results_admin2.csv** **6. M4_combined_results_admin3.csv** **Structure**: <div class="language-text highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>admin_area_1, [admin_area_2/3], year, indicator_common_id, denominator_best_or_survey, value
</span></code></pre></div> **Fields**: - `indicator_common_id`: Health indicator (e.g., `anc1`, `penta3`) - `denominator_best_or_survey`: Either `best`, `survey`, or specific denominator name - `value`: Coverage percentage (0-100+) **Special "best" Entry**: Duplicates the selected optimal denominator for easy filtering </details> <details> <summary><strong>Data Safeguards and Validation</strong></summary> Part 1 includes multiple validation checks: 1. **ISO3 Validation**: Ensures survey and population data match HMIS country 2. **Geographic Matching**: Validates admin area names between HMIS and survey - Reports match rate (e.g., "15/20 regions match") - Falls back to higher geographic level if mismatch detected 3. **Fallback Mechanisms**: - Subnational → National if no local survey data - SBA → Delivery if SBA missing - PNC1_mother → PNC1 if missing 4. **Edge Case Handling**: Detects when admin_area_3 should be used as admin_area_2 (e.g., Afghanistan districts) 5. **Empty Data Handling**: Creates empty CSVs with correct structure when data unavailable 6. **Error Handling**: Wraps survey processing in `tryCatch` to handle mismatches gracefully </details> <details> <summary><strong>Indicators Supported</strong></summary> Part 1 processes the following health indicators: **Maternal Health**: - `anc1`: Antenatal care 1st visit - `anc4`: Antenatal care 4+ visits - `delivery`: Institutional delivery - `sba`: Skilled birth attendance - `pnc1`: Postnatal care (child) - `pnc1_mother`: Postnatal care (mother) **Immunization**: - `bcg`: BCG vaccine - `penta1`, `penta2`, `penta3`: Pentavalent vaccine - `measles1`, `measles2`: Measles-containing vaccine - `rota1`, `rota2`: Rotavirus vaccine - `opv1`, `opv2`, `opv3`: Oral polio vaccine - `fully_immunized`: Full immunization status **Child Health**: - `nmr`: Neonatal mortality rate (survey only) - `imr`: Infant mortality rate (survey only) - `vitaminA`: Vitamin A supplementation </details> <details> <summary><strong>Usage Notes and Best Practices</strong></summary> #### When to Use Which Count Variable - `count_final_none`: No adjustments (raw reported data) - `count_final_outlier`: Outlier adjustment only - `count_final_completeness`: Completeness adjustment only - `count_final_both`: Both adjustments **(recommended)** #### Interpreting "best" Denominators The "best" denominator may vary by indicator and area based on: - Data availability (some services not universally reported) - Reporting completeness (affects HMIS-based denominators) - Population projection quality (affects WPP denominators) - Survey coverage levels (extreme values reduce denominator options) #### Why Multiple Denominators? Different denominators serve different purposes: - **Independent denominators**: Provide cross-validation between services - **Reference denominators**: Show internal HMIS consistency (but excluded from "best" by default) - **WPP denominators**: Offer population-based benchmarks - Comparing multiple options reveals data quality issues </details> <details> <summary><strong>Troubleshooting Common Issues</strong></summary> **Issue**: No matching admin areas between HMIS and survey - **Solution**: Check ISO3 code is correct; verify admin area naming conventions; module will fall back to national analysis **Issue**: All denominators show >100% coverage - **Solution**: May indicate under-reporting in survey or over-reporting in HMIS; check data quality from Module 2 **Issue**: UNWPP selected as "best" for most indicators - **Solution**: May indicate poor HMIS data quality or completeness; review Module 2 adjustments </details> <hr> <h3 id=part-2-denominator-selection-projection-technical-details>Part 2: Denominator Selection &amp; Projection (Technical Details)<a class=headerlink href=#part-2-denominator-selection-projection-technical-details title="Anchor link to this section">&para;</a></h3> <details> <summary><strong>Purpose and Objectives</strong></summary> Part 2 serves three key purposes: 1. **User-Driven Denominator Selection**: While Part 1 automatically selects the "best" denominator by minimizing error against survey data, Part 2 allows users to override this selection and choose specific denominators based on programmatic knowledge or policy priorities 2. **Temporal Trend Analysis**: Computes year-over-year changes (deltas) in coverage to understand service delivery trends over time 3. **Survey Projection**: Projects survey-based coverage estimates forward in time using trends observed in administrative (HMIS) data, filling gaps where survey data is unavailable </details> <details> <summary><strong>Input Data Requirements</strong></summary> Part 2 requires the following inputs from Part 1: | Input File | Description | Key Columns | |-----------|-------------|-------------| | `M4_combined_results_national.csv` | Combined coverage estimates for all denominators at national level | admin_area_1, year, indicator_common_id, denominator_best_or_survey, value | | `M4_combined_results_admin2.csv` | Combined coverage estimates for admin level 2 | admin_area_1, admin_area_2, year, indicator_common_id, denominator_best_or_survey, value | | `M4_combined_results_admin3.csv` | Combined coverage estimates for admin level 3 | admin_area_1, admin_area_3, year, indicator_common_id, denominator_best_or_survey, value | These files contain: - Coverage estimates calculated using different denominators - Survey values for comparison - A "best" denominator selection from Part 1 - Source and source detail information </details> <details> <summary><strong>User Configuration Parameters</strong></summary> Users configure Part 2 through two key parameter sets: #### 1. Denominator Selection Configuration At the top of the script, users specify which denominator to use for each indicator: <div class="language-r highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>DENOMINATOR_SELECTION</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=nf>list</span><span class=p>(</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>  </span><span class=c1># PREGNANCY-RELATED INDICATORS</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>  </span><span class=n>anc1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span><span class=w>                    </span><span class=c1># Options: &quot;best&quot;, &quot;danc1_pregnancy&quot;, &quot;ddelivery_pregnancy&quot;, &quot;dbcg_pregnancy&quot;, &quot;dlivebirths_pregnancy&quot;, &quot;dwpp_pregnancy&quot;</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>  </span><span class=n>anc4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=w>  </span><span class=c1># LIVE BIRTH-RELATED INDICATORS</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=w>  </span><span class=n>delivery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span><span class=w>                </span><span class=c1># Options: &quot;best&quot;, &quot;danc1_livebirth&quot;, &quot;ddelivery_livebirth&quot;, &quot;dbcg_livebirth&quot;, &quot;dlivebirths_livebirth&quot;, &quot;dwpp_livebirth&quot;</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=w>  </span><span class=n>bcg</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=w>  </span><span class=n>sba</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=w>  </span><span class=n>pnc1_mother</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=w>  </span><span class=n>pnc1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=w>  </span><span class=c1># DPT-ELIGIBLE AGE GROUP INDICATORS</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=w>  </span><span class=n>penta1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span><span class=w>                  </span><span class=c1># Options: &quot;best&quot;, &quot;danc1_dpt&quot;, &quot;ddelivery_dpt&quot;, &quot;dpenta1_dpt&quot;, &quot;dbcg_dpt&quot;, &quot;dlivebirths_dpt&quot;, &quot;dwpp_dpt&quot;</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=w>  </span><span class=n>penta2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=w>  </span><span class=n>penta3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=w>  </span><span class=n>opv1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=w>  </span><span class=n>opv2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-19><a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=w>  </span><span class=n>opv3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-20><a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a>
</span><span id=__span-14-21><a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>  </span><span class=c1># MEASLES-ELIGIBLE AGE GROUP INDICATORS</span>
</span><span id=__span-14-22><a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=w>  </span><span class=n>measles1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span><span class=w>                </span><span class=c1># Options: &quot;best&quot;, &quot;danc1_measles1&quot;, &quot;ddelivery_measles1&quot;, &quot;dpenta1_measles1&quot;, &quot;dbcg_measles1&quot;, &quot;dlivebirths_measles1&quot;, &quot;dwpp_measles1&quot;</span>
</span><span id=__span-14-23><a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=w>  </span><span class=n>measles2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span>
</span><span id=__span-14-24><a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a>
</span><span id=__span-14-25><a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a><span class=w>  </span><span class=c1># ADDITIONAL INDICATORS</span>
</span><span id=__span-14-26><a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a><span class=w>  </span><span class=n>vitaminA</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=p>,</span><span class=w>                </span><span class=c1># Options: &quot;best&quot;, &quot;danc1_vitaminA&quot;, &quot;dbcg_vitaminA&quot;, &quot;ddelivery_vitaminA&quot;, &quot;dwpp_vitaminA&quot;</span>
</span><span id=__span-14-27><a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a><span class=w>  </span><span class=n>fully_immunized</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;best&quot;</span><span class=w>          </span><span class=c1># Options: &quot;best&quot;, &quot;danc1_fully_immunized&quot;, &quot;dbcg_fully_immunized&quot;, &quot;ddelivery_fully_immunized&quot;, &quot;dwpp_fully_immunized&quot;</span>
</span><span id=__span-14-28><a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a><span class=p>)</span>
</span></code></pre></div> **Denominator Options by Indicator Type:** The available denominators vary by indicator type based on the appropriate target population: - **Pregnancy-based indicators** (ANC1, ANC4): Use pregnancy-adjusted denominators - **Live birth-based indicators** (Delivery, BCG, SBA, PNC): Use live birth-adjusted denominators - **DPT-eligible age group** (Penta1-3, OPV1-3): Use DPT-adjusted denominators (children eligible for DPT) - **Measles-eligible age group** (Measles1, Measles2): Use measles-adjusted denominators (children eligible for measles vaccine) Each denominator option combines a source (ANC1, Delivery, BCG, Penta1, or WPP) with an age-adjustment factor. #### 2. Administrative Level Configuration <div class="language-r highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>RUN_NATIONAL</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kc>TRUE</span><span class=w>  </span><span class=c1># Always TRUE - national analysis is mandatory</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=n>RUN_ADMIN2</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kc>TRUE</span><span class=w>    </span><span class=c1># Enable/disable admin level 2 analysis</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=n>RUN_ADMIN3</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kc>TRUE</span><span class=w>    </span><span class=c1># Enable/disable admin level 3 analysis</span>
</span></code></pre></div> The script automatically checks data availability and disables admin levels with no data. </details> <details> <summary><strong>Core Functions and Methods</strong></summary> #### Function 1: `coverage_deltas()` **Purpose**: Calculates year-over-year changes in coverage for each indicator-denominator-geography combination. **Algorithm**: <div class="language-r highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=n>coverage_deltas</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kr>function</span><span class=p>(</span><span class=n>coverage_df</span><span class=p>,</span><span class=w> </span><span class=n>lag_n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>1</span><span class=p>,</span><span class=w> </span><span class=n>complete_years</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>TRUE</span><span class=p>)</span>
</span></code></pre></div> **Process**: 1. Groups data by geography (admin areas), indicator, and denominator 2. Optionally fills in missing years to create a complete time series 3. Sorts data chronologically within each group 4. Calculates delta as: $\Delta\text{coverage}_t = \text{coverage}_t - \text{coverage}_{t-1}$ **Mathematical Formulation**: $$ \Delta C_{i,d,g,t} = C_{i,d,g,t} - C_{i,d,g,t-1} $$ where: - $C$ = coverage estimate - $i$ = indicator - $d$ = denominator - $g$ = geographic area - $t$ = time (year) **Input**: - `coverage_df`: Data frame with coverage estimates - `lag_n`: Number of years to lag (default = 1 for year-over-year) - `complete_years`: Whether to fill missing years (default = TRUE) **Output**: Data frame with original coverage values plus a `delta` column showing year-over-year change. **Example Output**: | admin_area_1 | indicator_common_id | denominator | year | coverage | delta | |--------------|-------------------|-------------|------|----------|-------| | Country A | penta3 | dpenta1_dpt | 2018 | 75.2 | NA | | Country A | penta3 | dpenta1_dpt | 2019 | 78.5 | 3.3 | | Country A | penta3 | dpenta1_dpt | 2020 | 80.1 | 1.6 | #### Function 2: `project_survey_from_deltas()` **Purpose**: Projects survey-based coverage estimates forward using administrative data trends. **Algorithm**: <div class="language-r highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=n>project_survey_from_deltas</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kr>function</span><span class=p>(</span><span class=n>deltas_df</span><span class=p>,</span><span class=w> </span><span class=n>survey_raw_long</span><span class=p>)</span>
</span></code></pre></div> **Process**: 1. **Identify Baseline**: For each geography-indicator combination, find the most recent survey observation - Extract the last observed survey year - Record the baseline coverage value at that year 2. **Attach Baseline to Each Denominator Path**: Since Part 2 operates on specific denominator selections, attach the baseline to each denominator series 3. **Compute Cumulative Deltas**: For years after the baseline year, calculate cumulative sum of deltas: $$\text{cumulative delta}_t = \sum_{\tau = \text{baseline year} + 1}^{t} \Delta C_\tau$$ 4. **Calculate Projection**: Add cumulative delta to baseline value: $$\text{Projected coverage}_t = \text{Baseline coverage} + \text{cumulative delta}_t$$ **Mathematical Formulation**: For each indicator $i$, denominator $d$, and geography $g$: 1. Find baseline: $$ y_{\text{baseline}} = \max\{t : S_{i,g,t} \text{ exists}\} $$ $$ S_{\text{baseline}} = S_{i,g,y_{\text{baseline}}} $$ 2. For $t > y_{\text{baseline}}$: $$ \hat{S}_{i,d,g,t} = S_{\text{baseline}} + \sum_{\tau = y_{\text{baseline}} + 1}^{t} \Delta C_{i,d,g,\tau} $$ where: - $S$ = survey-based coverage estimate - $\hat{S}$ = projected survey coverage - $\Delta C$ = year-over-year change in administrative coverage **Assumptions**: - Trends observed in administrative data reflect true changes in service coverage - The baseline survey provides an accurate reference point - Administrative data trends can be applied to survey estimates **Input**: - `deltas_df`: Output from `coverage_deltas()` containing coverage changes - `survey_raw_long`: Raw survey data with years and values **Output**: Data frame with projected coverage for each year, indicator, denominator, and geography combination. **Example Output**: | admin_area_1 | indicator_common_id | denominator | year | baseline_year | projected | |--------------|-------------------|-------------|------|---------------|-----------| | Country A | penta3 | dpenta1_dpt | 2018 | 2018 | 75.0 | | Country A | penta3 | dpenta1_dpt | 2019 | 2018 | 78.3 | | Country A | penta3 | dpenta1_dpt | 2020 | 2018 | 79.9 | #### Function 3: `build_final_results()` **Purpose**: Combines HMIS coverage, projected survey estimates, and original survey values into a unified output dataset. **Algorithm**: <div class="language-r highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=n>build_final_results</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=kr>function</span><span class=p>(</span><span class=n>coverage_df</span><span class=p>,</span><span class=w> </span><span class=n>proj_df</span><span class=p>,</span><span class=w> </span><span class=n>survey_raw_df</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>NULL</span><span class=p>)</span>
</span></code></pre></div> **Process**: 1. **Prepare HMIS Coverage**: Extract coverage estimates from administrative data - Rename coverage column to `coverage_cov` for clarity 2. **Merge Projections**: Join projected survey estimates - Match by geography, year, indicator, and denominator - Create `coverage_avgsurveyprojection` column 3. **Process Original Survey Data** (if available): - Collapse multiple survey sources by taking mean value - Preserve source metadata (source, source_detail) - Expand survey values across all denominators for that indicator 4. **Calculate Final Projections**: Use an improved projection formula that anchors to the last survey value: For years after the last survey year: $$ \text{Projected coverage}_t = \text{Last survey value} + (C_{\text{HMIS},t} - C_{\text{HMIS, last survey year}}) $$ This additive approach: - Preserves the calibration to survey data - Applies the HMIS trend (delta) to extend the estimate forward - Avoids compounding errors from year-to-year deltas 5. **Combine Results**: Merge all components using full outer join to preserve: - Years with only HMIS data - Years with only survey data - Years with both data sources **Mathematical Formulation**: Let: - $t_s$ = year of last survey - $S_{t_s}$ = survey coverage at year $t_s$ - $C_{\text{HMIS},t}$ = HMIS-based coverage at year $t$ For $t > t_s$: $$ \hat{C}_t = S_{t_s} + (C_{\text{HMIS},t} - C_{\text{HMIS},t_s}) $$ **Input**: - `coverage_df`: HMIS-based coverage estimates from selected denominators - `proj_df`: Projected survey estimates from `project_survey_from_deltas()` - `survey_raw_df`: Original survey data (optional) **Output**: Comprehensive data frame with columns: - Geographic identifiers (admin_area_1, admin_area_2, admin_area_3) - year, indicator_common_id, denominator - `coverage_cov`: HMIS-based coverage - `coverage_original_estimate`: Original survey values - `coverage_avgsurveyprojection`: Projected survey coverage - `survey_raw_source`: Survey data source (e.g., "DHS", "MICS") - `survey_raw_source_detail`: Detailed source information </details> <details> <summary><strong>Helper Functions</strong></summary> #### `filter_by_denominator_selection()` **Purpose**: Filters the combined results from Part 1 based on user's denominator selection. **Algorithm**: 1. Iterate through each indicator in `DENOMINATOR_SELECTION` 2. For each indicator: - If selection is "best": Keep rows where `denominator_best_or_survey == "best"` - If selection is a specific denominator: Keep rows where `denominator_best_or_survey == selected_denominator` 3. Convert selected rows to coverage format (rename columns, filter out survey entries) 4. Combine results across all indicators **Input**: - `combined_results_df`: Output from Part 1 with all denominator options - `selection_list`: The DENOMINATOR_SELECTION configuration list **Output**: Filtered data frame containing only the user-selected denominators. #### `extract_survey_from_combined()` **Purpose**: Extracts raw survey values from Part 1 combined results. **Algorithm**: 1. Filter for rows where `denominator_best_or_survey == "survey"` 2. Rename `value` column to `survey_value` 3. Select relevant columns dynamically based on admin levels present **Input**: Combined results data frame from Part 1 **Output**: Survey data frame with columns: admin areas, year, indicator_common_id, survey_value </details> <details> <summary><strong>Workflow Execution Steps</strong></summary> Part 2 executes the following workflow for each administrative level (national, admin2, admin3): **Step 1: Load Data** - Load combined results from Part 1 for all admin levels - Check which admin levels have data - Extract survey data for use as projection baseline - Display messages about data availability **Step 2: For Each Admin Level** **Sub-step 1: Filter by Denominator Selection** - Apply user's denominator choices using `filter_by_denominator_selection()` - Message: Number of records selected **Sub-step 2: Compute Deltas** - Calculate year-over-year coverage changes using `coverage_deltas()` - Creates complete time series with gaps filled **Sub-step 3: Project Survey Values** - Use `project_survey_from_deltas()` to extend survey estimates - Baseline is anchored to most recent survey - Projections use cumulative deltas from HMIS trends **Sub-step 4: Build Final Results** - Combine HMIS coverage, projections, and original surveys - Calculate final projected estimates using additive formula - Preserve all metadata **Step 3: Standardize and Save Outputs** - Define required columns for each admin level - Ensure all required columns exist (add as NA if missing) - Order columns correctly - Remove inappropriate admin level columns - Save as CSV with UTF-8 encoding - Create empty files for admin levels with no data </details> <details> <summary><strong>Output Specifications</strong></summary> Part 2 produces three output files: #### 1. National Output: `M5_coverage_estimation_national.csv` **Columns**: - `admin_area_1`: Country name - `year`: Year of estimate - `indicator_common_id`: Standardized indicator code - `denominator`: Selected denominator source - `coverage_original_estimate`: Original survey-based coverage (NA for years without surveys) - `coverage_avgsurveyprojection`: Projected survey coverage using HMIS trends - `coverage_cov`: HMIS-based coverage estimate - `survey_raw_source`: Survey source (e.g., "DHS 2018") - `survey_raw_source_detail`: Additional source details **Note**: Does NOT include admin_area_2 or admin_area_3 columns. #### 2. Admin Level 2 Output: `M5_coverage_estimation_admin2.csv` **Columns**: Same as national, plus: - `admin_area_2`: Second-level administrative division name (e.g., province, region) **Note**: Does NOT include admin_area_3 column. #### 3. Admin Level 3 Output: `M5_coverage_estimation_admin3.csv` **Columns**: - `admin_area_1`: Country name - `admin_area_3`: Third-level administrative division name (e.g., district) - `year`: Year of estimate - `indicator_common_id`: Standardized indicator code - `denominator`: Selected denominator source - `coverage_original_estimate`: Original survey coverage - `coverage_avgsurveyprojection`: Projected survey coverage - `coverage_cov`: HMIS-based coverage - `survey_raw_source`: Survey source - `survey_raw_source_detail`: Source details **Note**: Does NOT include admin_area_2 column (skips straight from admin_area_1 to admin_area_3). </details> <details> <summary><strong>Methodological Considerations</strong></summary> #### 1. Denominator Selection Strategy **When to use "best"**: - Uncertain about which denominator is most appropriate - Want to rely on data-driven selection from Part 1 - Starting point for analysis **When to specify a denominator**: - Programmatic knowledge suggests a specific denominator is most accurate - Policy requirements dictate use of specific population estimates - Conducting sensitivity analyses - Known issues with certain data sources #### 2. Projection Methodology The projection approach in Part 2 uses an **additive delta method** rather than multiplicative or direct replacement: **Advantages**: - Preserves the level calibration from survey data - Smoothly extends survey estimates using administrative trends - Avoids compounding errors from year-to-year changes - Maintains consistency when HMIS coverage is stable **Limitations**: - Assumes HMIS trends reflect true coverage changes - May diverge from reality if administrative data quality declines - Projections become less reliable further from baseline survey - Does not account for systematic biases in HMIS data **Best Practice**: Projections should be validated against new survey data when available, and the baseline should be updated with the most recent survey. #### 3. Handling Missing Data Part 2 implements several strategies for missing data: - **Complete time series**: The `coverage_deltas()` function can fill missing years, creating a continuous series - **Survey gaps**: Projections extend estimates forward, but years before the first survey remain NA - **Admin level gaps**: Script automatically detects and skips admin levels with no data - **Missing denominators**: If a selected denominator doesn't exist for an indicator, that indicator-denominator combination is omitted #### 4. Multi-Level Analysis Consistency Part 2 processes each administrative level independently: - **National**: Aggregated country-level estimates - **Admin 2**: Provincial/regional estimates (may not sum to national due to different denominators) - **Admin 3**: District-level estimates **Important**: Estimates across levels may not be directly comparable if different denominators are selected or if data quality varies by level. </details> <details> <summary><strong>Example Use Case</strong></summary> **Scenario**: Analyst wants to estimate Penta3 coverage for 2015-2024 using Penta1-derived denominators. **Configuration**: <div class="language-r highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>DENOMINATOR_SELECTION</span><span class=w> </span><span class=o>&lt;-</span><span class=w> </span><span class=nf>list</span><span class=p>(</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=w>  </span><span class=n>penta3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;dpenta1_dpt&quot;</span><span class=w>  </span><span class=c1># Override &quot;best&quot; to use Penta1-based denominator</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=p>)</span>
</span></code></pre></div> **Input Data**: - Part 1 combined results with multiple denominators calculated - Survey data available for 2018 (75.0% coverage) - HMIS data available for all years 2015-2024 **Process**: 1. **Filter**: Extract only Penta3 estimates using dpenta1_dpt denominator 2. **Compute Deltas**: Calculate year-over-year changes in HMIS-based coverage 3. **Project**: - Baseline year: 2018 (last survey) - Baseline value: 75.0% - For 2019: 75.0% + (HMIS 2019 - HMIS 2018) - For 2020: 75.0% + (HMIS 2020 - HMIS 2018) - Continue through 2024 **Output**: - Years 2015-2017: Only HMIS coverage available - Year 2018: Survey value (75.0%) and HMIS coverage - Years 2019-2024: Projected coverage based on HMIS trends </details> <details> <summary><strong>Validation and Quality Checks</strong></summary> Users should validate Part 2 outputs by: 1. **Checking projection reasonableness**: - Are projected values within plausible ranges (0-100%)? - Do trends make programmatic sense? 2. **Comparing denominators**: - Run Part 2 with different denominator selections - Assess sensitivity of results to denominator choice 3. **Validating against new surveys**: - When new survey data becomes available, compare projections to actual values - Update baseline and re-run if necessary 4. **Reviewing HMIS trends**: - Large deltas may indicate data quality issues - Sudden changes should be investigated 5. **Admin level consistency**: - Check if subnational trends align with national patterns - Investigate large discrepancies </details> <details> <summary><strong>Integration with Part 1</strong></summary> Part 2 builds directly on Part 1 outputs: | Part 1 Output | Part 2 Use | |---------------|------------| | Combined results with all denominators | Input for denominator filtering | | "Best" denominator selections | Default option if user doesn't specify | | Coverage estimates | Basis for delta calculations | | Survey values | Baseline for projections | | Source metadata | Preserved in final output | **Workflow Connection**: <div class="language-text highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>Part 1: Calculate denominators → Select &quot;best&quot; → Output combined results
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>                                                          ↓
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>Part 2: User selects denominators → Calculate trends → Project surveys → Final estimates
</span></code></pre></div> </details> <details> <summary><strong>Troubleshooting Common Issues</strong></summary> **Issue**: "No data in admin2 combined results" - **Cause**: Part 1 didn't process admin level 2, or no subnational data exists - **Solution**: Set `RUN_ADMIN2 <- FALSE` or check Part 1 inputs **Issue**: Projections show implausible values (>100% or <0%) - **Cause**: Large errors in HMIS data or inappropriate denominator - **Solution**: Review denominator selection, check HMIS data quality, consider different denominator **Issue**: Missing denominators in output - **Cause**: Selected denominator not calculated in Part 1 for that indicator - **Solution**: Check Part 1 denominator options, verify indicator-denominator compatibility **Issue**: Gaps in projected coverage - **Cause**: Missing HMIS data for some years - **Solution**: Review Module 2 outputs, check data completeness adjustments </details> <hr> <p>Last edit: 2025 November 8</p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../03_module_service_utilization_documentation/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Module 3 · Service Utilization"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Module 3 · Service Utilization </div> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 FASTR Methodology Documentation </div> </div> <div class=md-social> <a href=/ target=_blank rel=noopener title=Home class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M277.8 8.6c-12.3-11.4-31.3-11.4-43.5 0l-224 208c-9.6 9-12.8 22.9-8 35.1S18.8 272 32 272h16v176c0 35.3 28.7 64 64 64h288c35.3 0 64-28.7 64-64V272h16c13.2 0 25-8.1 29.8-20.3s1.6-26.2-8-35.1zM240 320h32c26.5 0 48 21.5 48 48v96H192v-96c0-26.5 21.5-48 48-48"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.footer", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link", "content.tooltips"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>